2026-01-08T14:27:29.467505958Z vite v7.1.12 building for production...
2026-01-08T14:27:29.689106721Z transforming...
2026-01-08T14:27:34.794224478Z âœ“ 2784 modules transformed.
2026-01-08T14:27:35.391350786Z rendering chunks...
2026-01-08T14:27:35.398048338Z [meta-images] no Replit deployment domain found, skipping meta tag updates
2026-01-08T14:27:35.402594478Z computing gzip size...
2026-01-08T14:27:35.427203745Z ../dist/public/index.html                   1.39 kB â”‚ gzip:   0.56 kB
2026-01-08T14:27:35.427222415Z ../dist/public/assets/index--LpjaBAy.css  109.98 kB â”‚ gzip:  17.57 kB
2026-01-08T14:27:35.427343438Z ../dist/public/assets/index-CXP3Q8t1.js   878.92 kB â”‚ gzip: 255.39 kB
2026-01-08T14:27:35.427521112Z 
2026-01-08T14:27:35.427533703Z (!) Some chunks are larger than 500 kB after minification. Consider:
2026-01-08T14:27:35.427539443Z - Using dynamic import() to code-split the application
2026-01-08T14:27:35.427544633Z - Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
2026-01-08T14:27:35.427549383Z - Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.
2026-01-08T14:27:35.42784174Z âœ“ built in 5.78s
2026-01-08T14:27:35.427989094Z building server...
2026-01-08T14:27:35.585191765Z 
2026-01-08T14:27:35.585218136Z   dist/index.cjs  977.0kb
2026-01-08T14:27:35.585221556Z 
2026-01-08T14:27:35.585226146Z âš¡ Done in 156ms
2026-01-08T14:27:40.03736736Z ==> Uploading build...
2026-01-08T14:28:00.362001456Z ==> Uploaded in 7.7s. Compression took 12.6s
2026-01-08T14:28:00.576611299Z ==> Build successful ðŸŽ‰
2026-01-08T14:28:10.13990605Z ==> Setting WEB_CONCURRENCY=1 by default, based on available CPUs in the instance
2026-01-08T14:28:10.156128739Z ==> Deploying...
2026-01-08T14:29:24.140711401Z ==> Running 'npm run start'
2026-01-08T14:29:24.949831767Z ==> No open ports detected, continuing to scan...
2026-01-08T14:29:25.031584795Z ==> Docs on specifying a port: https://render.com/docs/web-services#port-binding
2026-01-08T14:29:25.144423517Z 
2026-01-08T14:29:25.144449068Z > rest-express@1.0.0 start
2026-01-08T14:29:25.144453179Z > NODE_ENV=production node dist/index.cjs
2026-01-08T14:29:25.144455279Z 
2026-01-08T14:29:25.948082768Z /opt/render/project/src/dist/index.cjs:69
2026-01-08T14:29:25.948141671Z 		`;await r.execute(m`CREATE SCHEMA IF NOT EXISTS ${m.identifier(i)}`),await r.execute(s);let p=(await r.all(m`select id, hash, created_at from ${m.identifier(i)}.${m.identifier(a)} order by created_at desc limit 1`))[0];await r.transaction(async c=>{for await(let l of e)if(!p||Number(p.created_at)<l.folderMillis){for(let u of l.sql)await c.execute(m.raw(u));await c.execute(m`insert into ${m.identifier(i)}.${m.identifier(a)} ("hash", "created_at") values(${l.hash}, ${l.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let r=[m`with `];for(let[n,a]of e.entries())r.push(m`${m.identifier(a._.alias)} as (${a._.sql})`),n<e.length-1&&r.push(m`, `);return r.push(m` `),m.join(r)}buildDeleteQuery({table:e,where:r,returning:n,withList:a}){let i=this.buildWithCTE(a),s=n?m` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,o=r?m` where ${r}`:void 0;return m`${i}delete from ${e}${o}${s}`}buildUpdateSet(e,r){let n=e[T.Symbol.Columns],a=Object.keys(n).filter(s=>r[s]!==void 0||n[s]?.onUpdateFn!==void 0),i=a.length;return m.join(a.flatMap((s,o)=>{let p=n[s],c=r[s]??m.param(p.onUpdateFn(),p),l=m`${m.identifier(this.casing.getColumnCasing(p))} = ${c}`;return o<i-1?[l,m.raw(", ")]:[l]}))}buildUpdateQuery({table:e,set:r,where:n,returning:a,withList:i,from:s,joins:o}){let p=this.buildWithCTE(i),c=e[Se.Symbol.Name],l=e[Se.Symbol.Schema],u=e[Se.Symbol.OriginalName],d=c===u?void 0:c,h=m`${l?m`${m.identifier(l)}.`:void 0}${m.identifier(u)}${d&&m` ${m.identifier(d)}`}`,v=this.buildUpdateSet(e,r),g=s&&m.join([m.raw(" from "),this.buildFromTable(s)]),b=this.buildJoins(o),E=a?m` returning ${this.buildSelection(a,{isSingleTable:!s})}`:void 0,q=n?m` where ${n}`:void 0;return m`${p}update ${h} set ${v}${g}${b}${q}${E}`}buildSelection(e,{isSingleTable:r=!1}={}){let n=e.length,a=e.flatMap(({field:i},s)=>{let o=[];if(y(i,A.Aliased)&&i.isSelectionField)o.push(m.identifier(i.fieldAlias));else if(y(i,A.Aliased)||y(i,A)){let p=y(i,A.Aliased)?i.sql:i;r?o.push(new A(p.queryChunks.map(c=>y(c,S)?m.identifier(this.casing.getColumnCasing(c)):c))):o.push(p),y(i,A.Aliased)&&o.push(m` as ${m.identifier(i.fieldAlias)}`)}else y(i,H)&&(r?o.push(m.identifier(this.casing.getColumnCasing(i))):o.push(i));return s<n-1&&o.push(m`, `),o});return m.join(a)}buildJoins(e){if(!e||e.length===0)return;let r=[];for(let[n,a]of e.entries()){n===0&&r.push(m` `);let i=a.table,s=a.lateral?m` lateral`:void 0;if(y(i,Se)){let o=i[Se.Symbol.Name],p=i[Se.Symbol.Schema],c=i[Se.Symbol.OriginalName],l=o===c?void 0:a.alias;r.push(m`${m.raw(a.joinType)} join${s} ${p?m`${m.identifier(p)}.`:void 0}${m.identifier(c)}${l&&m` ${m.identifier(l)}`} on ${a.on}`)}else if(y(i,ze)){let o=i[te].name,p=i[te].schema,c=i[te].originalName,l=o===c?void 0:a.alias;r.push(m`${m.raw(a.joinType)} join${s} ${p?m`${m.identifier(p)}.`:void 0}${m.identifier(c)}${l&&m` ${m.identifier(l)}`} on ${a.on}`)}else r.push(m`${m.raw(a.joinType)} join${s} ${i} on ${a.on}`);n<e.length-1&&r.push(m` `)}return m.join(r)}buildFromTable(e){if(y(e,T)&&e[T.Symbol.OriginalName]!==e[T.Symbol.Name]){let r=m`${m.identifier(e[T.Symbol.OriginalName])}`;return e[T.Symbol.Schema]&&(r=m`${m.identifier(e[T.Symbol.Schema])}.${r}`),m`${r} ${m.identifier(e[T.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:n,where:a,having:i,table:s,joins:o,orderBy:p,groupBy:c,limit:l,offset:u,lockingClause:d,distinct:h,setOperators:v}){let g=n??et(r);for(let se of g)if(y(se.field,H)&&Be(se.field.table)!==(y(s,fe)?s._.alias:y(s,vn)?s[te].name:y(s,A)?void 0:Be(s))&&!(ve=>o?.some(({alias:_t})=>_t===(ve[T.Symbol.IsAlias]?Be(ve):ve[T.Symbol.BaseName])))(se.field.table)){let ve=Be(se.field.table);throw new Error(`Your "${se.path.join("->")}" field references a column "${ve}"."${se.field.name}", but the table "${ve}" is not part of the query! Did you forget to join it?`)}let b=!o||o.length===0,E=this.buildWithCTE(e),q;h&&(q=h===!0?m` distinct`:m` distinct on (${m.join(h.on,m`, `)})`);let _=this.buildSelection(g,{isSingleTable:b}),z=this.buildFromTable(s),V=this.buildJoins(o),R=a?m` where ${a}`:void 0,P=i?m` having ${i}`:void 0,$;p&&p.length>0&&($=m` order by ${m.join(p,m`, `)}`);let ne;c&&c.length>0&&(ne=m` group by ${m.join(c,m`, `)}`);let Ne=typeof l=="object"||typeof l=="number"&&l>=0?m` limit ${l}`:void 0,at=u?m` offset ${u}`:void 0,Ge=m.empty();if(d){let se=m` for ${m.raw(d.strength)}`;d.config.of&&se.append(m` of ${m.join(Array.isArray(d.config.of)?d.config.of:[d.config.of],m`, `)}`),d.config.noWait?se.append(m` no wait`):d.config.skipLocked&&se.append(m` skip locked`),Ge.append(se)}let ue=m`${E}select${q} ${_} from ${z}${V}${R}${ne}${P}${$}${Ne}${at}${Ge}`;return v.length>0?this.buildSetOperations(ue,v):ue}buildSetOperations(e,r){let[n,...a]=r;if(!n)throw new Error("Cannot pass undefined values to any set operator");return a.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),a)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:n,rightSelect:a,limit:i,orderBy:s,offset:o}}){let p=m`(${e.getSQL()}) `,c=m`(${a.getSQL()})`,l;if(s&&s.length>0){let v=[];for(let g of s)if(y(g,S))v.push(m.identifier(g.name));else if(y(g,A)){for(let b=0;b<g.queryChunks.length;b++){let E=g.queryChunks[b];y(E,S)&&(g.queryChunks[b]=m.identifier(E.name))}v.push(m`${g}`)}else v.push(m`${g}`);l=m` order by ${m.join(v,m`, `)} `}let u=typeof i=="object"||typeof i=="number"&&i>=0?m` limit ${i}`:void 0,d=m.raw(`${r} ${n?"all ":""}`),h=o?m` offset ${o}`:void 0;return m`${p}${d}${c}${l}${u}${h}`}buildInsertQuery({table:e,values:r,onConflict:n,returning:a,withList:i,select:s,overridingSystemValue_:o}){let p=[],c=e[T.Symbol.Columns],l=Object.entries(c).filter(([E,q])=>!q.shouldDisableInsert()),u=l.map(([,E])=>m.identifier(this.casing.getColumnCasing(E)));if(s){let E=r;y(E,A)?p.push(E):p.push(E.getSQL())}else{let E=r;p.push(m.raw("values "));for(let[q,_]of E.entries()){let z=[];for(let[V,R]of l){let P=_[V];if(P===void 0||y(P,Me)&&P.value===void 0)if(R.defaultFn!==void 0){let $=R.defaultFn(),ne=y($,A)?$:m.param($,R);z.push(ne)}else if(!R.default&&R.onUpdateFn!==void 0){let $=R.onUpdateFn(),ne=y($,A)?$:m.param($,R);z.push(ne)}else z.push(m`default`);else z.push(P)}p.push(z),q<E.length-1&&p.push(m`, `)}}let d=this.buildWithCTE(i),h=m.join(p),v=a?m` returning ${this.buildSelection(a,{isSingleTable:!0})}`:void 0,g=n?m` on conflict ${n}`:void 0,b=o===!0?m`overriding system value `:void 0;return m`${d}insert into ${e} ${u} ${b}${h}${g}${v}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:n}){let a=r?m` concurrently`:void 0,i=n?m` with no data`:void 0;return m`refresh materialized view${a} ${e}${i}`}prepareTyping(e){return y(e,qa)||y(e,ja)?"json":y(e,Pa)?"decimal":y(e,Oa)?"time":y(e,Ia)||y(e,za)?"timestamp":y(e,Aa)||y(e,Na)?"date":y(e,$a)?"uuid":"none"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:a,tableConfig:i,queryConfig:s,tableAlias:o,nestedQueryRelation:p,joinOn:c}){let l=[],u,d,h=[],v,g=[];if(s===!0)l=Object.entries(i.columns).map(([q,_])=>({dbKey:_.name,tsKey:q,field:xt(_,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let E=Object.fromEntries(Object.entries(i.columns).map(([P,$])=>[P,xt($,o)]));if(s.where){let P=typeof s.where=="function"?s.where(E,by()):s.where;v=P&&_a(P,o)}let q=[],_=[];if(s.columns){let P=!1;for(let[$,ne]of Object.entries(s.columns))ne!==void 0&&$ in i.columns&&(!P&&ne===!0&&(P=!0),_.push($));_.length>0&&(_=P?_.filter($=>s.columns?.[$]===!0):Object.keys(i.columns).filter($=>!_.includes($)))}else _=Object.keys(i.columns);for(let P of _){let $=i.columns[P];q.push({tsKey:P,value:$})}let z=[];s.with&&(z=Object.entries(s.with).filter(P=>!!P[1]).map(([P,$])=>({tsKey:P,queryConfig:$,relation:i.relations[P]})));let V;if(s.extras){V=typeof s.extras=="function"?s.extras(E,{sql:m}):s.extras;for(let[P,$]of Object.entries(V))q.push({tsKey:P,value:dp($,o)})}for(let{tsKey:P,value:$}of q)l.push({dbKey:y($,A.Aliased)?$.fieldAlias:i.columns[P].name,tsKey:P,field:y($,H)?xt($,o):$,relationTableTsKey:void 0,isJson:!1,selection:[]});let R=typeof s.orderBy=="function"?s.orderBy(E,wy()):s.orderBy??[];Array.isArray(R)||(R=[R]),h=R.map(P=>y(P,H)?xt(P,o):_a(P,o)),u=s.limit,d=s.offset;for(let{tsKey:P,queryConfig:$,relation:ne}of z){let Ne=ky(r,n,ne),at=fr(ne.referencedTable),Ge=n[at],ue=`${o}_${P}`,se=Da(...Ne.fields.map((jn,Fs)=>Ze(xt(Ne.references[Fs],ue),xt(jn,o)))),ve=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:e[Ge],tableConfig:r[Ge],queryConfig:y(ne,Qt)?$===!0?{limit:1}:{...$,limit:1}:$,tableAlias:ue,joinOn:se,nestedQueryRelation:ne}),_t=m`${m.identifier(ue)}.${m.identifier("data")}`.as(P);g.push({on:m`true`,table:new fe(ve.sql,{},ue),alias:ue,joinType:"left",lateral:!0}),l.push({dbKey:P,tsKey:P,field:_t,relationTableTsKey:Ge,isJson:!0,selection:ve.selection})}}if(l.length===0)throw new Ca({message:`No fields selected for table "${i.tsName}" ("${o}")`});let b;if(v=Da(c,v),p){let E=m`json_build_array(${m.join(l.map(({field:z,tsKey:V,isJson:R})=>R?m`${m.identifier(`${o}_${V}`)}.${m.identifier("data")}`:y(z,A.Aliased)?z.sql:z),m`, `)})`;y(p,Ra)&&(E=m`coalesce(json_agg(${E}${h.length>0?m` order by ${m.join(h,m`, `)}`:void 0}), '[]'::json)`);let q=[{dbKey:"data",tsKey:"data",field:E.as("data"),isJson:!0,relationTableTsKey:i.tsName,selection:l}];u!==void 0||d!==void 0||h.length>0?(b=this.buildSelectQuery({table:ka(a,o),fields:{},fieldsFlat:[{path:[],field:m.raw("*")}],where:v,limit:u,offset:d,orderBy:h,setOperators:[]}),v=void 0,u=void 0,d=void 0,h=[]):b=ka(a,o),b=this.buildSelectQuery({table:y(b,Se)?b:new fe(b,{},o),fields:{},fieldsFlat:q.map(({field:z})=>({path:[],field:y(z,H)?xt(z,o):z})),joins:g,where:v,limit:u,offset:d,orderBy:h,setOperators:[]})}else b=this.buildSelectQuery({table:ka(a,o),fields:{},fieldsFlat:l.map(({field:E})=>({path:[],field:y(E,H)?xt(E,o):E})),joins:g,where:v,limit:u,offset:d,orderBy:h,setOperators:[]});return{tableTsKey:i.tsName,sql:b,selection:l}}};var xs=class{static[f]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}};var Ce=class{static[f]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let r=!!this.fields,n=e,a;return this.fields?a=this.fields:y(n,fe)?a=Object.fromEntries(Object.keys(n._.selectedFields).map(i=>[i,n[i]])):y(n,vn)?a=n[te].selectedFields:y(n,A)?a={}:a=ds(n),new ys({table:n,fields:a,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},Pl=class extends xs{static[f]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:n,session:a,dialect:i,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...r},distinct:o,setOperators:[]},this.isPartialSelect=n,this.session=a,this.dialect=i,this._={selectedFields:r},this.tableName=Ct(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}createJoin(e){return(r,n)=>{let a=this.tableName,i=Ct(r);if(typeof i=="string"&&this.config.joins?.some(s=>s.alias===i))throw new Error(`Alias "${i}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof a=="string"&&(this.config.fields={[a]:this.config.fields}),typeof i=="string"&&!y(r,A))){let s=y(r,fe)?r._.selectedFields:y(r,ze)?r[te].selectedFields:r[T.Symbol.Columns];this.config.fields[i]=s}if(typeof n=="function"&&(n=n(new Proxy(this.config.fields,new pe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:r,joinType:e,alias:i}),typeof i=="string")switch(e){case"left":{this.joinsNotNullableMap[i]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[i]=!0;break}case"inner":{this.joinsNotNullableMap[i]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,r){return n=>{let a=typeof n=="function"?n(H6()):n;if(!Ta(this.getSelectedFields(),a.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:r,rightSelect:a}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new pe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new pe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new pe({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new pe({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),n=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new fe(this.getSQL(),this.config.fields,e),new pe({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new pe({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}},ys=class extends Pl{static[f]="PgSelect";_prepare(e){let{session:r,config:n,dialect:a,joinsNotNullableMap:i,authToken:s}=this;if(!r)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return ee.startActiveSpan("drizzle.prepareQuery",()=>{let o=et(n.fields),p=r.prepareQuery(a.sqlToQuery(this.getSQL()),o,e,!0);return p.joinsNotNullableMap=i,p.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};bx(ys,[Ee]);function gn(t,e){return(r,n,...a)=>{let i=[n,...a].map(s=>({type:t,isAll:e,rightSelect:s}));for(let s of i)if(!Ta(r.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return r.addSetOperators(i)}}var H6=()=>({union:G6,unionAll:K6,intersect:W6,intersectAll:Z6,except:J6,exceptAll:X6}),G6=gn("union",!1),K6=gn("union",!0),W6=gn("intersect",!1),Z6=gn("intersect",!0),J6=gn("except",!1),X6=gn("except",!0);var xn=class{static[f]="PgQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=y(e,Ht)?e:void 0,this.dialectConfig=y(e,Ht)?void 0:e}$with=(e,r)=>{let n=this;return{as:i=>(typeof i=="function"&&(i=i(n)),new Proxy(new mn(i.getSQL(),r??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new pe({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...e){let r=this;function n(s){return new Ce({fields:s??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function a(s){return new Ce({fields:s??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function i(s,o){return new Ce({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:s}})}return{select:n,selectDistinct:a,selectDistinctOn:i}}select(e){return new Ce({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new Ce({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new Ce({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new Ht(this.dialectConfig)),this.dialect}};var La=class{constructor(e,r,n,a,i){this.table=e,this.session=r,this.dialect=n,this.withList=a,this.overridingSystemValue_=i}static[f]="PgInsertBuilder";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error("values() must be called with at least one value");let r=e.map(n=>{let a={},i=this.table[T.Symbol.Columns];for(let s of Object.keys(n)){let o=n[s];a[s]=y(o,A)?o:new Me(o,i[s])}return a});return new bs(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let r=typeof e=="function"?e(new xn):e;if(!y(r,A)&&!Ta(this.table[ls],r._.selectedFields))throw new Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new bs(this.table,r,this.session,this.dialect,this.withList,!0)}},bs=class extends Ee{constructor(e,r,n,a,i,s,o){super(),this.session=n,this.dialect=a,this.config={table:e,values:r,withList:i,select:s,overridingSystemValue_:o}}static[f]="PgInsert";config;returning(e=this.config.table[T.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=et(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=m`do nothing`;else{let r="";r=Array.isArray(e.target)?e.target.map(a=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(a))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let n=e.where?m` where ${e.where}`:void 0;this.config.onConflict=m`(${m.raw(r)})${n} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let r=e.where?m` where ${e.where}`:void 0,n=e.targetWhere?m` where ${e.targetWhere}`:void 0,a=e.setWhere?m` where ${e.setWhere}`:void 0,i=this.dialect.buildUpdateSet(this.config.table,us(this.config.table,e.set)),s="";return s=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=m`(${m.raw(s)})${n} do update set ${i}${r}${a}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new pe({alias:Be(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var ws=class extends Ee{constructor(e,r,n){super(),this.session=r,this.dialect=n,this.config={view:e}}static[f]="PgRefreshMaterializedView";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};var Ba=class{constructor(e,r,n,a){this.table=e,this.session=r,this.dialect=n,this.withList=a}static[f]="PgUpdateBuilder";authToken;setToken(e){return this.authToken=e,this}set(e){return new Ol(this.table,us(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Ol=class extends Ee{constructor(e,r,n,a,i){super(),this.session=n,this.dialect=a,this.config={set:r,table:e,withList:i,joins:[]},this.tableName=Ct(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}static[f]="PgUpdate";config;tableName;joinsNotNullableMap;from(e){let r=e,n=Ct(r);return typeof n=="string"&&(this.joinsNotNullableMap[n]=!0),this.config.from=r,this}getTableLikeFields(e){return y(e,Se)?e[T.Symbol.Columns]:y(e,fe)?e._.selectedFields:e[te].selectedFields}createJoin(e){return(r,n)=>{let a=Ct(r);if(typeof a=="string"&&this.config.joins.some(i=>i.alias===a))throw new Error(`Alias "${a}" is already used in this query`);if(typeof n=="function"){let i=this.config.from&&!y(this.config.from,A)?this.getTableLikeFields(this.config.from):void 0;n=n(new Proxy(this.config.table[T.Symbol.Columns],new pe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),i&&new Proxy(i,new pe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:n,table:r,joinType:e,alias:a}),typeof a=="string")switch(e){case"left":{this.joinsNotNullableMap[a]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([i])=>[i,!1])),this.joinsNotNullableMap[a]=!0;break}case"inner":{this.joinsNotNullableMap[a]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([i])=>[i,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[T.Symbol.Columns]),this.config.from)){let r=Ct(this.config.from);if(typeof r=="string"&&this.config.from&&!y(this.config.from,A)){let n=this.getTableLikeFields(this.config.from);e[r]=n}for(let n of this.config.joins){let a=Ct(n.table);if(typeof a=="string"&&!y(n.table,A)){let i=this.getTableLikeFields(n.table);e[a]=i}}}return this.config.returningFields=e,this.config.returning=et(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){let r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new pe({alias:Be(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var Ss=class t extends A{constructor(e){super(t.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=t.buildCount(e.source,e.filters)}sql;token;static[f]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(e,r){return m`(select count(*) from ${e}${m.raw(" where ").if(r)}${r})`}static buildCount(e,r){return m`select count(*) as count from ${e}${m.raw(" where ").if(r)}${r};`}setToken(e){return this.token=e,this}then(e,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,r)}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}};var ks=class{constructor(e,r,n,a,i,s,o){this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=a,this.tableConfig=i,this.dialect=s,this.session=o}static[f]="PgRelationalQueryBuilder";findMany(e){return new _s(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new _s(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}},_s=class extends Ee{constructor(e,r,n,a,i,s,o,p,c){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=a,this.tableConfig=i,this.dialect=s,this.session=o,this.config=p,this.mode=c}static[f]="PgRelationalQuery";_prepare(e){return ee.startActiveSpan("drizzle.prepareQuery",()=>{let{query:r,builtQuery:n}=this._toSQL();return this.session.prepareQuery(n,void 0,e,!0,(a,i)=>{let s=a.map(o=>gs(this.schema,this.tableConfig,o,r.selection,i));return this.mode==="first"?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ee.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}};var Ts=class extends Ee{constructor(e,r,n,a){super(),this.execute=e,this.sql=r,this.query=n,this.mapBatchResult=a}static[f]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var yn=class{constructor(e,r,n){if(this.dialect=e,this.session=r,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[a,i]of Object.entries(this._.schema))this.query[a]=new ks(n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[a],i,e,r)}static[f]="PgDatabase";query;$with=(e,r)=>{let n=this;return{as:i=>(typeof i=="function"&&(i=i(new xn(n.dialect))),new Proxy(new mn(i.getSQL(),r??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new pe({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(e,r){return new Ss({source:e,filters:r,session:this.session})}with(...e){let r=this;function n(c){return new Ce({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e})}function a(c){return new Ce({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function i(c,l){return new Ce({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:c}})}function s(c){return new Ba(c,r.session,r.dialect,e)}function o(c){return new La(c,r.session,r.dialect,e)}function p(c){return new Ea(c,r.session,r.dialect,e)}return{select:n,selectDistinct:a,selectDistinctOn:i,update:s,insert:o,delete:p}}select(e){return new Ce({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new Ce({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new Ce({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Ba(e,this.session,this.dialect)}insert(e){return new La(e,this.session,this.dialect)}delete(e){return new Ea(e,this.session,this.dialect)}refreshMaterializedView(e){return new ws(e,this.session,this.dialect)}authToken;execute(e){let r=typeof e=="string"?m.raw(e):e.getSQL(),n=this.dialect.sqlToQuery(r),a=this.session.prepareQuery(n,void 0,void 0,!1);return new Ts(()=>a.execute(void 0,this.authToken),r,n,i=>a.mapResult(i,!0))}transaction(e,r){return this.session.transaction(e,r)}};var Es=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}static[f]="PgPreparedQuery";joinsNotNullableMap},Cs=class{constructor(e){this.dialect=e}static[f]="PgSession";execute(e,r){return ee.startActiveSpan("drizzle.operation",()=>ee.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){let n=await this.execute(e,r);return Number(n[0].count)}},As=class extends yn{constructor(e,r,n,a=0){super(e,r,n),this.schema=n,this.nestedIndex=a}static[f]="PgTransaction";rollback(){throw new ms}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable=="boolean"&&r.push(e.deferrable?"deferrable":"not deferrable"),m.raw(r.join(" "))}setTransaction(e){return this.session.execute(m`set transaction ${this.getTransactionConfigSQL(e)}`)}};var Il=class extends Es{constructor(e,r,n,a,i,s,o){super({sql:r,params:n}),this.client=e,this.queryString=r,this.params=n,this.logger=a,this.fields=i,this._isResponseInArrayMode=s,this.customResultMapper=o}static[f]="PostgresJsPreparedQuery";async execute(e={}){return ee.startActiveSpan("drizzle.execute",async r=>{let n=up(this.params,e);r?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(n)}),this.logger.logQuery(this.queryString,n);let{fields:a,queryString:i,client:s,joinsNotNullableMap:o,customResultMapper:p}=this;if(!a&&!p)return ee.startActiveSpan("drizzle.driver.execute",()=>s.unsafe(i,n));let c=await ee.startActiveSpan("drizzle.driver.execute",()=>(r?.setAttributes({"drizzle.query.text":i,"drizzle.query.params":JSON.stringify(n)}),s.unsafe(i,n).values()));return ee.startActiveSpan("drizzle.mapResponse",()=>p?p(c):c.map(l=>yx(a,l,o)))})}all(e={}){return ee.startActiveSpan("drizzle.execute",async r=>{let n=up(this.params,e);return r?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(n)}),this.logger.logQuery(this.queryString,n),ee.startActiveSpan("drizzle.driver.execute",()=>(r?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(n)}),this.client.unsafe(this.queryString,n)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}},Ma=class t extends Cs{constructor(e,r,n,a={}){super(r),this.client=e,this.schema=n,this.options=a,this.logger=a.logger??new is}static[f]="PostgresJsSession";logger;prepareQuery(e,r,n,a,i){return new Il(this.client,e.sql,e.params,this.logger,r,a,i)}query(e,r){return this.logger.logQuery(e,r),this.client.unsafe(e,r).values()}queryObjects(e,r){return this.client.unsafe(e,r)}transaction(e,r){return this.client.begin(async n=>{let a=new t(n,this.dialect,this.schema,this.options),i=new zl(this.dialect,a,this.schema);return r&&await i.setTransaction(r),e(i)})}},zl=class t extends As{constructor(e,r,n,a=0){super(e,r,n,a),this.session=r}static[f]="PostgresJsTransaction";transaction(e){return this.session.client.savepoint(r=>{let n=new Ma(r,this.dialect,this.schema,this.session.options),a=new t(this.dialect,n,this.schema);return e(a)})}};var $l=class extends yn{static[f]="PostgresJsDatabase"};function bn(t,e={}){let r=p=>p;for(let p of["1184","1082","1083","1114"])t.options.parsers[p]=r,t.options.serializers[p]=r;t.options.serializers[114]=r,t.options.serializers[3802]=r;let n=new Ht({casing:e.casing}),a;e.logger===!0?a=new as:e.logger!==!1&&(a=e.logger);let i;if(e.schema){let p=Sy(e.schema,_y);i={fullSchema:e.schema,schema:p.tables,tableNamesMap:p.tableNamesMap}}let s=new Ma(t,n,i,{logger:a}),o=new $l(n,s,i);return o.$client=t,o}function js(...t){if(typeof t[0]=="string"){let e=(0,Ns.default)(t[0]);return bn(e,t[1])}if(Sx(t[0])){let{connection:e,client:r,...n}=t[0];if(r)return bn(r,n);if(typeof e=="object"&&e.url!==void 0){let{url:i,...s}=e,o=(0,Ns.default)(i,s);return bn(o,n)}let a=(0,Ns.default)(e);return bn(a,n)}return bn(t[0],t[1])}(t=>{function e(r){return bn({options:{parsers:{},serializers:{}}},r)}t.mock=e})(js||(js={}));var My=Or(require("postgres"),1);var B={};Vl(B,{BRAND:()=>_5,DIRTY:()=>vr,EMPTY_PATH:()=>r5,INVALID:()=>O,NEVER:()=>cT,OK:()=>Ae,ParseStatus:()=>ke,Schema:()=>D,ZodAny:()=>Wt,ZodArray:()=>Pt,ZodBigInt:()=>xr,ZodBoolean:()=>yr,ZodBranded:()=>Va,ZodCatch:()=>jr,ZodDate:()=>br,ZodDefault:()=>Nr,ZodDiscriminatedUnion:()=>Os,ZodEffects:()=>nt,ZodEnum:()=>Cr,ZodError:()=>Qe,ZodFirstPartyTypeKind:()=>I,ZodFunction:()=>zs,ZodIntersection:()=>_r,ZodIssueCode:()=>w,ZodLazy:()=>Tr,ZodLiteral:()=>Er,ZodMap:()=>En,ZodNaN:()=>An,ZodNativeEnum:()=>Ar,ZodNever:()=>pt,ZodNull:()=>Sr,ZodNullable:()=>kt,ZodNumber:()=>gr,ZodObject:()=>He,ZodOptional:()=>tt,ZodParsedType:()=>C,ZodPipeline:()=>Qa,ZodPromise:()=>Zt,ZodReadonly:()=>qr,ZodRecord:()=>Is,ZodSchema:()=>D,ZodSet:()=>Cn,ZodString:()=>Kt,ZodSymbol:()=>_n,ZodTransformer:()=>nt,ZodTuple:()=>St,ZodType:()=>D,ZodUndefined:()=>wr,ZodUnion:()=>kr,ZodUnknown:()=>qt,ZodVoid:()=>Tn,addIssueToContext:()=>k,any:()=>O5,array:()=>F5,bigint:()=>A5,boolean:()=>zy,coerce:()=>oT,custom:()=>Py,date:()=>N5,datetimeRegex:()=>jy,defaultErrorMap:()=>Nt,discriminatedUnion:()=>B5,effect:()=>Y5,enum:()=>Z5,function:()=>G5,getErrorMap:()=>wn,getParsedType:()=>wt,instanceof:()=>E5,intersection:()=>M5,isAborted:()=>qs,isAsync:()=>Sn,isDirty:()=>Ps,isValid:()=>Gt,late:()=>T5,lazy:()=>K5,literal:()=>W5,makeIssue:()=>Ua,map:()=>Q5,nan:()=>C5,nativeEnum:()=>J5,never:()=>z5,null:()=>P5,nullable:()=>tT,number:()=>Iy,object:()=>D5,objectUtil:()=>Fl,oboolean:()=>sT,onumber:()=>iT,optional:()=>eT,ostring:()=>aT,pipeline:()=>nT,preprocess:()=>rT,promise:()=>X5,quotelessJson:()=>Y6,record:()=>V5,set:()=>H5,setErrorMap:()=>t5,strictObject:()=>R5,string:()=>Oy,symbol:()=>j5,transformer:()=>Y5,tuple:()=>U5,undefined:()=>q5,union:()=>L5,unknown:()=>I5,util:()=>L,void:()=>$5});var L;(function(t){t.assertEqual=a=>{};function e(a){}t.assertIs=e;function r(a){throw new Error}t.assertNever=r,t.arrayToEnum=a=>{let i={};for(let s of a)i[s]=s;return i},t.getValidEnumValues=a=>{let i=t.objectKeys(a).filter(o=>typeof a[a[o]]!="number"),s={};for(let o of i)s[o]=a[o];return t.objectValues(s)},t.objectValues=a=>t.objectKeys(a).map(function(i){return a[i]}),t.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{let i=[];for(let s in a)Object.prototype.hasOwnProperty.call(a,s)&&i.push(s);return i},t.find=(a,i)=>{for(let s of a)if(i(s))return s},t.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function n(a,i=" | "){return a.map(s=>typeof s=="string"?`'${s}'`:s).join(i)}t.joinValues=n,t.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(L||(L={}));var Fl;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(Fl||(Fl={}));var C=L.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),wt=t=>{switch(typeof t){case"undefined":return C.undefined;case"string":return C.string;case"number":return Number.isNaN(t)?C.nan:C.number;case"boolean":return C.boolean;case"function":return C.function;case"bigint":return C.bigint;case"symbol":return C.symbol;case"object":return Array.isArray(t)?C.array:t===null?C.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?C.promise:typeof Map<"u"&&t instanceof Map?C.map:typeof Set<"u"&&t instanceof Set?C.set:typeof Date<"u"&&t instanceof Date?C.date:C.object;default:return C.unknown}};var w=L.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Y6=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),Qe=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(i){return i.message},n={_errors:[]},a=i=>{for(let s of i.issues)if(s.code==="invalid_union")s.unionErrors.map(a);else if(s.code==="invalid_return_type")a(s.returnTypeError);else if(s.code==="invalid_arguments")a(s.argumentsError);else if(s.path.length===0)n._errors.push(r(s));else{let o=n,p=0;for(;p<s.path.length;){let c=s.path[p];p===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],p++}}};return a(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,L.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let a of this.issues)if(a.path.length>0){let i=a.path[0];r[i]=r[i]||[],r[i].push(e(a))}else n.push(e(a));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};Qe.create=t=>new Qe(t);var e5=(t,e)=>{let r;switch(t.code){case w.invalid_type:t.received===C.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case w.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,L.jsonStringifyReplacer)}`;break;case w.unrecognized_keys:r=`Unrecognized key(s) in object: ${L.joinValues(t.keys,", ")}`;break;case w.invalid_union:r="Invalid input";break;case w.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${L.joinValues(t.options)}`;break;case w.invalid_enum_value:r=`Invalid enum value. Expected ${L.joinValues(t.options)}, received '${t.received}'`;break;case w.invalid_arguments:r="Invalid function arguments";break;case w.invalid_return_type:r="Invalid function return type";break;case w.invalid_date:r="Invalid date";break;case w.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:L.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case w.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case w.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case w.custom:r="Invalid input";break;case w.invalid_intersection_types:r="Intersection results could not be merged";break;case w.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case w.not_finite:r="Number must be finite";break;default:r=e.defaultError,L.assertNever(t)}return{message:r}},Nt=e5;var Ty=Nt;function t5(t){Ty=t}function wn(){return Ty}var Ua=t=>{let{data:e,path:r,errorMaps:n,issueData:a}=t,i=[...r,...a.path||[]],s={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let o="",p=n.filter(c=>!!c).slice().reverse();for(let c of p)o=c(s,{data:e,defaultError:o}).message;return{...a,path:i,message:o}},r5=[];function k(t,e){let r=wn(),n=Ua({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===Nt?void 0:Nt].filter(a=>!!a)});t.common.issues.push(n)}var ke=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let n=[];for(let a of r){if(a.status==="aborted")return O;a.status==="dirty"&&e.dirty(),n.push(a.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let a of r){let i=await a.key,s=await a.value;n.push({key:i,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let a of r){let{key:i,value:s}=a;if(i.status==="aborted"||s.status==="aborted")return O;i.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof s.value<"u"||a.alwaysSet)&&(n[i.value]=s.value)}return{status:e.value,value:n}}},O=Object.freeze({status:"aborted"}),vr=t=>({status:"dirty",value:t}),Ae=t=>({status:"valid",value:t}),qs=t=>t.status==="aborted",Ps=t=>t.status==="dirty",Gt=t=>t.status==="valid",Sn=t=>typeof Promise<"u"&&t instanceof Promise;var j;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(j||(j={}));var rt=class{constructor(e,r,n,a){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Ey=(t,e)=>{if(Gt(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new Qe(t.common.issues);return this._error=r,this._error}}};function F(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:a}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(s,o)=>{let{message:p}=t;return s.code==="invalid_enum_value"?{message:p??o.defaultError}:typeof o.data>"u"?{message:p??n??o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:p??r??o.defaultError}},description:a}}var D=class{get description(){return this._def.description}_getType(e){return wt(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:wt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ke,ctx:{common:e.parent.common,data:e.data,parsedType:wt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Sn(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:wt(e)},a=this._parseSync({data:e,path:n.path,parent:n});return Ey(n,a)}"~validate"(e){let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:wt(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return Gt(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>Gt(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:wt(e)},a=this._parse({data:e,path:n.path,parent:n}),i=await(Sn(a)?a:Promise.resolve(a));return Ey(n,i)}refine(e,r){let n=a=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(a):r;return this._refinement((a,i)=>{let s=e(a),o=()=>i.addIssue({code:w.custom,...n(a)});return typeof Promise<"u"&&s instanceof Promise?s.then(p=>p?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((n,a)=>e(n)?!0:(a.addIssue(typeof r=="function"?r(n,a):r),!1))}_refinement(e){return new nt({schema:this,typeName:I.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return tt.create(this,this._def)}nullable(){return kt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Pt.create(this)}promise(){return Zt.create(this,this._def)}or(e){return kr.create([this,e],this._def)}and(e){return _r.create(this,e,this._def)}transform(e){return new nt({...F(this._def),schema:this,typeName:I.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new Nr({...F(this._def),innerType:this,defaultValue:r,typeName:I.ZodDefault})}brand(){return new Va({typeName:I.ZodBranded,type:this,...F(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new jr({...F(this._def),innerType:this,catchValue:r,typeName:I.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return Qa.create(this,e)}readonly(){return qr.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},n5=/^c[^\s-]{8,}$/i,a5=/^[0-9a-z]+$/,i5=/^[0-9A-HJKMNP-TV-Z]{26}$/i,s5=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,o5=/^[a-z0-9_-]{21}$/i,c5=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,p5=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,l5=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,u5="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Dl,d5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,f5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,m5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,h5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,v5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,g5=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Ay="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",x5=new RegExp(`^${Ay}$`);function Ny(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);let r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function y5(t){return new RegExp(`^${Ny(t)}$`)}function jy(t){let e=`${Ay}T${Ny(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function b5(t,e){return!!((e==="v4"||!e)&&d5.test(t)||(e==="v6"||!e)&&m5.test(t))}function w5(t,e){if(!c5.test(t))return!1;try{let[r]=t.split(".");if(!r)return!1;let n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),a=JSON.parse(atob(n));return!(typeof a!="object"||a===null||"typ"in a&&a?.typ!=="JWT"||!a.alg||e&&a.alg!==e)}catch{return!1}}function S5(t,e){return!!((e==="v4"||!e)&&f5.test(t)||(e==="v6"||!e)&&h5.test(t))}var Kt=class t extends D{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==C.string){let i=this._getOrReturnCtx(e);return k(i,{code:w.invalid_type,expected:C.string,received:i.parsedType}),O}let n=new ke,a;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(a=this._getOrReturnCtx(e,a),k(a,{code:w.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(a=this._getOrReturnCtx(e,a),k(a,{code:w.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){let s=e.data.length>i.value,o=e.data.length<i.value;(s||o)&&(a=this._getOrReturnCtx(e,a),s?k(a,{code:w.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&k(a,{code:w.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")l5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"email",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")Dl||(Dl=new RegExp(u5,"u")),Dl.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"emoji",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")s5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"uuid",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")o5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"nanoid",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")n5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"cuid",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")a5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"cuid2",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")i5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"ulid",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),k(a,{validation:"url",code:w.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"regex",code:w.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(e,a),k(a,{code:w.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(a=this._getOrReturnCtx(e,a),k(a,{code:w.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(a=this._getOrReturnCtx(e,a),k(a,{code:w.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?jy(i).test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{code:w.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?x5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{code:w.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?y5(i).test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{code:w.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?p5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"duration",code:w.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?b5(e.data,i.version)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"ip",code:w.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?w5(e.data,i.alg)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"jwt",code:w.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?S5(e.data,i.version)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"cidr",code:w.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?v5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"base64",code:w.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?g5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"base64url",code:w.invalid_string,message:i.message}),n.dirty()):L.assertNever(i);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(a=>e.test(a),{validation:r,code:w.invalid_string,...j.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...j.errToObj(e)})}url(e){return this._addCheck({kind:"url",...j.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...j.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...j.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...j.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...j.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...j.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...j.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...j.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...j.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...j.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...j.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...j.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...j.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...j.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...j.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...j.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...j.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...j.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...j.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...j.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...j.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...j.errToObj(r)})}nonempty(e){return this.min(1,j.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Kt.create=t=>new Kt({checks:[],typeName:I.ZodString,coerce:t?.coerce??!1,...F(t)});function k5(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,a=r>n?r:n,i=Number.parseInt(t.toFixed(a).replace(".","")),s=Number.parseInt(e.toFixed(a).replace(".",""));return i%s/10**a}var gr=class t extends D{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==C.number){let i=this._getOrReturnCtx(e);return k(i,{code:w.invalid_type,expected:C.number,received:i.parsedType}),O}let n,a=new ke;for(let i of this._def.checks)i.kind==="int"?L.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:w.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:w.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:w.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?k5(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),k(n,{code:w.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:w.not_finite,message:i.message}),a.dirty()):L.assertNever(i);return{status:a.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,j.toString(r))}gt(e,r){return this.setLimit("min",e,!1,j.toString(r))}lte(e,r){return this.setLimit("max",e,!0,j.toString(r))}lt(e,r){return this.setLimit("max",e,!1,j.toString(r))}setLimit(e,r,n,a){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:j.toString(a)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:j.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:j.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:j.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:j.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:j.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:j.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:j.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:j.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:j.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&L.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}};gr.create=t=>new gr({checks:[],typeName:I.ZodNumber,coerce:t?.coerce||!1,...F(t)});var xr=class t extends D{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==C.bigint)return this._getInvalidInput(e);let n,a=new ke;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:w.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:w.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),k(n,{code:w.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):L.assertNever(i);return{status:a.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return k(r,{code:w.invalid_type,expected:C.bigint,received:r.parsedType}),O}gte(e,r){return this.setLimit("min",e,!0,j.toString(r))}gt(e,r){return this.setLimit("min",e,!1,j.toString(r))}lte(e,r){return this.setLimit("max",e,!0,j.toString(r))}lt(e,r){return this.setLimit("max",e,!1,j.toString(r))}setLimit(e,r,n,a){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:j.toString(a)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:j.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:j.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:j.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive
2026-01-08T14:29:28.413255116Z ==> Exited with status 1
2026-01-08T14:29:28.430563734Z ==> Common ways to troubleshoot your deploy: https://render.com/docs/troubleshooting-deploys
2026-01-08T14:29:32.664155836Z ==> Running 'npm run start'
2026-01-08T14:29:33.669288034Z 
2026-01-08T14:29:33.669317166Z > rest-express@1.0.0 start
2026-01-08T14:29:33.669325196Z > NODE_ENV=production node dist/index.cjs
2026-01-08T14:29:33.669329637Z 
2026-01-08T14:29:34.471171552Z /opt/render/project/src/dist/index.cjs:69
2026-01-08T14:29:34.477079895Z 		`;await r.execute(m`CREATE SCHEMA IF NOT EXISTS ${m.identifier(i)}`),await r.execute(s);let p=(await r.all(m`select id, hash, created_at from ${m.identifier(i)}.${m.identifier(a)} order by created_at desc limit 1`))[0];await r.transaction(async c=>{for await(let l of e)if(!p||Number(p.created_at)<l.folderMillis){for(let u of l.sql)await c.execute(m.raw(u));await c.execute(m`insert into ${m.identifier(i)}.${m.identifier(a)} ("hash", "created_at") values(${l.hash}, ${l.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let r=[m`with `];for(let[n,a]of e.entries())r.push(m`${m.identifier(a._.alias)} as (${a._.sql})`),n<e.length-1&&r.push(m`, `);return r.push(m` `),m.join(r)}buildDeleteQuery({table:e,where:r,returning:n,withList:a}){let i=this.buildWithCTE(a),s=n?m` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,o=r?m` where ${r}`:void 0;return m`${i}delete from ${e}${o}${s}`}buildUpdateSet(e,r){let n=e[T.Symbol.Columns],a=Object.keys(n).filter(s=>r[s]!==void 0||n[s]?.onUpdateFn!==void 0),i=a.length;return m.join(a.flatMap((s,o)=>{let p=n[s],c=r[s]??m.param(p.onUpdateFn(),p),l=m`${m.identifier(this.casing.getColumnCasing(p))} = ${c}`;return o<i-1?[l,m.raw(", ")]:[l]}))}buildUpdateQuery({table:e,set:r,where:n,returning:a,withList:i,from:s,joins:o}){let p=this.buildWithCTE(i),c=e[Se.Symbol.Name],l=e[Se.Symbol.Schema],u=e[Se.Symbol.OriginalName],d=c===u?void 0:c,h=m`${l?m`${m.identifier(l)}.`:void 0}${m.identifier(u)}${d&&m` ${m.identifier(d)}`}`,v=this.buildUpdateSet(e,r),g=s&&m.join([m.raw(" from "),this.buildFromTable(s)]),b=this.buildJoins(o),E=a?m` returning ${this.buildSelection(a,{isSingleTable:!s})}`:void 0,q=n?m` where ${n}`:void 0;return m`${p}update ${h} set ${v}${g}${b}${q}${E}`}buildSelection(e,{isSingleTable:r=!1}={}){let n=e.length,a=e.flatMap(({field:i},s)=>{let o=[];if(y(i,A.Aliased)&&i.isSelectionField)o.push(m.identifier(i.fieldAlias));else if(y(i,A.Aliased)||y(i,A)){let p=y(i,A.Aliased)?i.sql:i;r?o.push(new A(p.queryChunks.map(c=>y(c,S)?m.identifier(this.casing.getColumnCasing(c)):c))):o.push(p),y(i,A.Aliased)&&o.push(m` as ${m.identifier(i.fieldAlias)}`)}else y(i,H)&&(r?o.push(m.identifier(this.casing.getColumnCasing(i))):o.push(i));return s<n-1&&o.push(m`, `),o});return m.join(a)}buildJoins(e){if(!e||e.length===0)return;let r=[];for(let[n,a]of e.entries()){n===0&&r.push(m` `);let i=a.table,s=a.lateral?m` lateral`:void 0;if(y(i,Se)){let o=i[Se.Symbol.Name],p=i[Se.Symbol.Schema],c=i[Se.Symbol.OriginalName],l=o===c?void 0:a.alias;r.push(m`${m.raw(a.joinType)} join${s} ${p?m`${m.identifier(p)}.`:void 0}${m.identifier(c)}${l&&m` ${m.identifier(l)}`} on ${a.on}`)}else if(y(i,ze)){let o=i[te].name,p=i[te].schema,c=i[te].originalName,l=o===c?void 0:a.alias;r.push(m`${m.raw(a.joinType)} join${s} ${p?m`${m.identifier(p)}.`:void 0}${m.identifier(c)}${l&&m` ${m.identifier(l)}`} on ${a.on}`)}else r.push(m`${m.raw(a.joinType)} join${s} ${i} on ${a.on}`);n<e.length-1&&r.push(m` `)}return m.join(r)}buildFromTable(e){if(y(e,T)&&e[T.Symbol.OriginalName]!==e[T.Symbol.Name]){let r=m`${m.identifier(e[T.Symbol.OriginalName])}`;return e[T.Symbol.Schema]&&(r=m`${m.identifier(e[T.Symbol.Schema])}.${r}`),m`${r} ${m.identifier(e[T.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:n,where:a,having:i,table:s,joins:o,orderBy:p,groupBy:c,limit:l,offset:u,lockingClause:d,distinct:h,setOperators:v}){let g=n??et(r);for(let se of g)if(y(se.field,H)&&Be(se.field.table)!==(y(s,fe)?s._.alias:y(s,vn)?s[te].name:y(s,A)?void 0:Be(s))&&!(ve=>o?.some(({alias:_t})=>_t===(ve[T.Symbol.IsAlias]?Be(ve):ve[T.Symbol.BaseName])))(se.field.table)){let ve=Be(se.field.table);throw new Error(`Your "${se.path.join("->")}" field references a column "${ve}"."${se.field.name}", but the table "${ve}" is not part of the query! Did you forget to join it?`)}let b=!o||o.length===0,E=this.buildWithCTE(e),q;h&&(q=h===!0?m` distinct`:m` distinct on (${m.join(h.on,m`, `)})`);let _=this.buildSelection(g,{isSingleTable:b}),z=this.buildFromTable(s),V=this.buildJoins(o),R=a?m` where ${a}`:void 0,P=i?m` having ${i}`:void 0,$;p&&p.length>0&&($=m` order by ${m.join(p,m`, `)}`);let ne;c&&c.length>0&&(ne=m` group by ${m.join(c,m`, `)}`);let Ne=typeof l=="object"||typeof l=="number"&&l>=0?m` limit ${l}`:void 0,at=u?m` offset ${u}`:void 0,Ge=m.empty();if(d){let se=m` for ${m.raw(d.strength)}`;d.config.of&&se.append(m` of ${m.join(Array.isArray(d.config.of)?d.config.of:[d.config.of],m`, `)}`),d.config.noWait?se.append(m` no wait`):d.config.skipLocked&&se.append(m` skip locked`),Ge.append(se)}let ue=m`${E}select${q} ${_} from ${z}${V}${R}${ne}${P}${$}${Ne}${at}${Ge}`;return v.length>0?this.buildSetOperations(ue,v):ue}buildSetOperations(e,r){let[n,...a]=r;if(!n)throw new Error("Cannot pass undefined values to any set operator");return a.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),a)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:n,rightSelect:a,limit:i,orderBy:s,offset:o}}){let p=m`(${e.getSQL()}) `,c=m`(${a.getSQL()})`,l;if(s&&s.length>0){let v=[];for(let g of s)if(y(g,S))v.push(m.identifier(g.name));else if(y(g,A)){for(let b=0;b<g.queryChunks.length;b++){let E=g.queryChunks[b];y(E,S)&&(g.queryChunks[b]=m.identifier(E.name))}v.push(m`${g}`)}else v.push(m`${g}`);l=m` order by ${m.join(v,m`, `)} `}let u=typeof i=="object"||typeof i=="number"&&i>=0?m` limit ${i}`:void 0,d=m.raw(`${r} ${n?"all ":""}`),h=o?m` offset ${o}`:void 0;return m`${p}${d}${c}${l}${u}${h}`}buildInsertQuery({table:e,values:r,onConflict:n,returning:a,withList:i,select:s,overridingSystemValue_:o}){let p=[],c=e[T.Symbol.Columns],l=Object.entries(c).filter(([E,q])=>!q.shouldDisableInsert()),u=l.map(([,E])=>m.identifier(this.casing.getColumnCasing(E)));if(s){let E=r;y(E,A)?p.push(E):p.push(E.getSQL())}else{let E=r;p.push(m.raw("values "));for(let[q,_]of E.entries()){let z=[];for(let[V,R]of l){let P=_[V];if(P===void 0||y(P,Me)&&P.value===void 0)if(R.defaultFn!==void 0){let $=R.defaultFn(),ne=y($,A)?$:m.param($,R);z.push(ne)}else if(!R.default&&R.onUpdateFn!==void 0){let $=R.onUpdateFn(),ne=y($,A)?$:m.param($,R);z.push(ne)}else z.push(m`default`);else z.push(P)}p.push(z),q<E.length-1&&p.push(m`, `)}}let d=this.buildWithCTE(i),h=m.join(p),v=a?m` returning ${this.buildSelection(a,{isSingleTable:!0})}`:void 0,g=n?m` on conflict ${n}`:void 0,b=o===!0?m`overriding system value `:void 0;return m`${d}insert into ${e} ${u} ${b}${h}${g}${v}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:n}){let a=r?m` concurrently`:void 0,i=n?m` with no data`:void 0;return m`refresh materialized view${a} ${e}${i}`}prepareTyping(e){return y(e,qa)||y(e,ja)?"json":y(e,Pa)?"decimal":y(e,Oa)?"time":y(e,Ia)||y(e,za)?"timestamp":y(e,Aa)||y(e,Na)?"date":y(e,$a)?"uuid":"none"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:a,tableConfig:i,queryConfig:s,tableAlias:o,nestedQueryRelation:p,joinOn:c}){let l=[],u,d,h=[],v,g=[];if(s===!0)l=Object.entries(i.columns).map(([q,_])=>({dbKey:_.name,tsKey:q,field:xt(_,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let E=Object.fromEntries(Object.entries(i.columns).map(([P,$])=>[P,xt($,o)]));if(s.where){let P=typeof s.where=="function"?s.where(E,by()):s.where;v=P&&_a(P,o)}let q=[],_=[];if(s.columns){let P=!1;for(let[$,ne]of Object.entries(s.columns))ne!==void 0&&$ in i.columns&&(!P&&ne===!0&&(P=!0),_.push($));_.length>0&&(_=P?_.filter($=>s.columns?.[$]===!0):Object.keys(i.columns).filter($=>!_.includes($)))}else _=Object.keys(i.columns);for(let P of _){let $=i.columns[P];q.push({tsKey:P,value:$})}let z=[];s.with&&(z=Object.entries(s.with).filter(P=>!!P[1]).map(([P,$])=>({tsKey:P,queryConfig:$,relation:i.relations[P]})));let V;if(s.extras){V=typeof s.extras=="function"?s.extras(E,{sql:m}):s.extras;for(let[P,$]of Object.entries(V))q.push({tsKey:P,value:dp($,o)})}for(let{tsKey:P,value:$}of q)l.push({dbKey:y($,A.Aliased)?$.fieldAlias:i.columns[P].name,tsKey:P,field:y($,H)?xt($,o):$,relationTableTsKey:void 0,isJson:!1,selection:[]});let R=typeof s.orderBy=="function"?s.orderBy(E,wy()):s.orderBy??[];Array.isArray(R)||(R=[R]),h=R.map(P=>y(P,H)?xt(P,o):_a(P,o)),u=s.limit,d=s.offset;for(let{tsKey:P,queryConfig:$,relation:ne}of z){let Ne=ky(r,n,ne),at=fr(ne.referencedTable),Ge=n[at],ue=`${o}_${P}`,se=Da(...Ne.fields.map((jn,Fs)=>Ze(xt(Ne.references[Fs],ue),xt(jn,o)))),ve=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:e[Ge],tableConfig:r[Ge],queryConfig:y(ne,Qt)?$===!0?{limit:1}:{...$,limit:1}:$,tableAlias:ue,joinOn:se,nestedQueryRelation:ne}),_t=m`${m.identifier(ue)}.${m.identifier("data")}`.as(P);g.push({on:m`true`,table:new fe(ve.sql,{},ue),alias:ue,joinType:"left",lateral:!0}),l.push({dbKey:P,tsKey:P,field:_t,relationTableTsKey:Ge,isJson:!0,selection:ve.selection})}}if(l.length===0)throw new Ca({message:`No fields selected for table "${i.tsName}" ("${o}")`});let b;if(v=Da(c,v),p){let E=m`json_build_array(${m.join(l.map(({field:z,tsKey:V,isJson:R})=>R?m`${m.identifier(`${o}_${V}`)}.${m.identifier("data")}`:y(z,A.Aliased)?z.sql:z),m`, `)})`;y(p,Ra)&&(E=m`coalesce(json_agg(${E}${h.length>0?m` order by ${m.join(h,m`, `)}`:void 0}), '[]'::json)`);let q=[{dbKey:"data",tsKey:"data",field:E.as("data"),isJson:!0,relationTableTsKey:i.tsName,selection:l}];u!==void 0||d!==void 0||h.length>0?(b=this.buildSelectQuery({table:ka(a,o),fields:{},fieldsFlat:[{path:[],field:m.raw("*")}],where:v,limit:u,offset:d,orderBy:h,setOperators:[]}),v=void 0,u=void 0,d=void 0,h=[]):b=ka(a,o),b=this.buildSelectQuery({table:y(b,Se)?b:new fe(b,{},o),fields:{},fieldsFlat:q.map(({field:z})=>({path:[],field:y(z,H)?xt(z,o):z})),joins:g,where:v,limit:u,offset:d,orderBy:h,setOperators:[]})}else b=this.buildSelectQuery({table:ka(a,o),fields:{},fieldsFlat:l.map(({field:E})=>({path:[],field:y(E,H)?xt(E,o):E})),joins:g,where:v,limit:u,offset:d,orderBy:h,setOperators:[]});return{tableTsKey:i.tsName,sql:b,selection:l}}};var xs=class{static[f]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}};var Ce=class{static[f]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let r=!!this.fields,n=e,a;return this.fields?a=this.fields:y(n,fe)?a=Object.fromEntries(Object.keys(n._.selectedFields).map(i=>[i,n[i]])):y(n,vn)?a=n[te].selectedFields:y(n,A)?a={}:a=ds(n),new ys({table:n,fields:a,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},Pl=class extends xs{static[f]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:n,session:a,dialect:i,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...r},distinct:o,setOperators:[]},this.isPartialSelect=n,this.session=a,this.dialect=i,this._={selectedFields:r},this.tableName=Ct(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}createJoin(e){return(r,n)=>{let a=this.tableName,i=Ct(r);if(typeof i=="string"&&this.config.joins?.some(s=>s.alias===i))throw new Error(`Alias "${i}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof a=="string"&&(this.config.fields={[a]:this.config.fields}),typeof i=="string"&&!y(r,A))){let s=y(r,fe)?r._.selectedFields:y(r,ze)?r[te].selectedFields:r[T.Symbol.Columns];this.config.fields[i]=s}if(typeof n=="function"&&(n=n(new Proxy(this.config.fields,new pe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:r,joinType:e,alias:i}),typeof i=="string")switch(e){case"left":{this.joinsNotNullableMap[i]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[i]=!0;break}case"inner":{this.joinsNotNullableMap[i]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,r){return n=>{let a=typeof n=="function"?n(H6()):n;if(!Ta(this.getSelectedFields(),a.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:r,rightSelect:a}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new pe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new pe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new pe({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new pe({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),n=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new fe(this.getSQL(),this.config.fields,e),new pe({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new pe({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}},ys=class extends Pl{static[f]="PgSelect";_prepare(e){let{session:r,config:n,dialect:a,joinsNotNullableMap:i,authToken:s}=this;if(!r)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return ee.startActiveSpan("drizzle.prepareQuery",()=>{let o=et(n.fields),p=r.prepareQuery(a.sqlToQuery(this.getSQL()),o,e,!0);return p.joinsNotNullableMap=i,p.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};bx(ys,[Ee]);function gn(t,e){return(r,n,...a)=>{let i=[n,...a].map(s=>({type:t,isAll:e,rightSelect:s}));for(let s of i)if(!Ta(r.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return r.addSetOperators(i)}}var H6=()=>({union:G6,unionAll:K6,intersect:W6,intersectAll:Z6,except:J6,exceptAll:X6}),G6=gn("union",!1),K6=gn("union",!0),W6=gn("intersect",!1),Z6=gn("intersect",!0),J6=gn("except",!1),X6=gn("except",!0);var xn=class{static[f]="PgQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=y(e,Ht)?e:void 0,this.dialectConfig=y(e,Ht)?void 0:e}$with=(e,r)=>{let n=this;return{as:i=>(typeof i=="function"&&(i=i(n)),new Proxy(new mn(i.getSQL(),r??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new pe({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...e){let r=this;function n(s){return new Ce({fields:s??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function a(s){return new Ce({fields:s??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function i(s,o){return new Ce({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:s}})}return{select:n,selectDistinct:a,selectDistinctOn:i}}select(e){return new Ce({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new Ce({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new Ce({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new Ht(this.dialectConfig)),this.dialect}};var La=class{constructor(e,r,n,a,i){this.table=e,this.session=r,this.dialect=n,this.withList=a,this.overridingSystemValue_=i}static[f]="PgInsertBuilder";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error("values() must be called with at least one value");let r=e.map(n=>{let a={},i=this.table[T.Symbol.Columns];for(let s of Object.keys(n)){let o=n[s];a[s]=y(o,A)?o:new Me(o,i[s])}return a});return new bs(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let r=typeof e=="function"?e(new xn):e;if(!y(r,A)&&!Ta(this.table[ls],r._.selectedFields))throw new Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new bs(this.table,r,this.session,this.dialect,this.withList,!0)}},bs=class extends Ee{constructor(e,r,n,a,i,s,o){super(),this.session=n,this.dialect=a,this.config={table:e,values:r,withList:i,select:s,overridingSystemValue_:o}}static[f]="PgInsert";config;returning(e=this.config.table[T.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=et(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=m`do nothing`;else{let r="";r=Array.isArray(e.target)?e.target.map(a=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(a))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let n=e.where?m` where ${e.where}`:void 0;this.config.onConflict=m`(${m.raw(r)})${n} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let r=e.where?m` where ${e.where}`:void 0,n=e.targetWhere?m` where ${e.targetWhere}`:void 0,a=e.setWhere?m` where ${e.setWhere}`:void 0,i=this.dialect.buildUpdateSet(this.config.table,us(this.config.table,e.set)),s="";return s=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=m`(${m.raw(s)})${n} do update set ${i}${r}${a}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new pe({alias:Be(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var ws=class extends Ee{constructor(e,r,n){super(),this.session=r,this.dialect=n,this.config={view:e}}static[f]="PgRefreshMaterializedView";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};var Ba=class{constructor(e,r,n,a){this.table=e,this.session=r,this.dialect=n,this.withList=a}static[f]="PgUpdateBuilder";authToken;setToken(e){return this.authToken=e,this}set(e){return new Ol(this.table,us(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Ol=class extends Ee{constructor(e,r,n,a,i){super(),this.session=n,this.dialect=a,this.config={set:r,table:e,withList:i,joins:[]},this.tableName=Ct(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}static[f]="PgUpdate";config;tableName;joinsNotNullableMap;from(e){let r=e,n=Ct(r);return typeof n=="string"&&(this.joinsNotNullableMap[n]=!0),this.config.from=r,this}getTableLikeFields(e){return y(e,Se)?e[T.Symbol.Columns]:y(e,fe)?e._.selectedFields:e[te].selectedFields}createJoin(e){return(r,n)=>{let a=Ct(r);if(typeof a=="string"&&this.config.joins.some(i=>i.alias===a))throw new Error(`Alias "${a}" is already used in this query`);if(typeof n=="function"){let i=this.config.from&&!y(this.config.from,A)?this.getTableLikeFields(this.config.from):void 0;n=n(new Proxy(this.config.table[T.Symbol.Columns],new pe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),i&&new Proxy(i,new pe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:n,table:r,joinType:e,alias:a}),typeof a=="string")switch(e){case"left":{this.joinsNotNullableMap[a]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([i])=>[i,!1])),this.joinsNotNullableMap[a]=!0;break}case"inner":{this.joinsNotNullableMap[a]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([i])=>[i,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[T.Symbol.Columns]),this.config.from)){let r=Ct(this.config.from);if(typeof r=="string"&&this.config.from&&!y(this.config.from,A)){let n=this.getTableLikeFields(this.config.from);e[r]=n}for(let n of this.config.joins){let a=Ct(n.table);if(typeof a=="string"&&!y(n.table,A)){let i=this.getTableLikeFields(n.table);e[a]=i}}}return this.config.returningFields=e,this.config.returning=et(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){let r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new pe({alias:Be(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var Ss=class t extends A{constructor(e){super(t.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=t.buildCount(e.source,e.filters)}sql;token;static[f]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(e,r){return m`(select count(*) from ${e}${m.raw(" where ").if(r)}${r})`}static buildCount(e,r){return m`select count(*) as count from ${e}${m.raw(" where ").if(r)}${r};`}setToken(e){return this.token=e,this}then(e,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,r)}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}};var ks=class{constructor(e,r,n,a,i,s,o){this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=a,this.tableConfig=i,this.dialect=s,this.session=o}static[f]="PgRelationalQueryBuilder";findMany(e){return new _s(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new _s(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}},_s=class extends Ee{constructor(e,r,n,a,i,s,o,p,c){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=a,this.tableConfig=i,this.dialect=s,this.session=o,this.config=p,this.mode=c}static[f]="PgRelationalQuery";_prepare(e){return ee.startActiveSpan("drizzle.prepareQuery",()=>{let{query:r,builtQuery:n}=this._toSQL();return this.session.prepareQuery(n,void 0,e,!0,(a,i)=>{let s=a.map(o=>gs(this.schema,this.tableConfig,o,r.selection,i));return this.mode==="first"?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ee.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}};var Ts=class extends Ee{constructor(e,r,n,a){super(),this.execute=e,this.sql=r,this.query=n,this.mapBatchResult=a}static[f]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var yn=class{constructor(e,r,n){if(this.dialect=e,this.session=r,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[a,i]of Object.entries(this._.schema))this.query[a]=new ks(n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[a],i,e,r)}static[f]="PgDatabase";query;$with=(e,r)=>{let n=this;return{as:i=>(typeof i=="function"&&(i=i(new xn(n.dialect))),new Proxy(new mn(i.getSQL(),r??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new pe({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(e,r){return new Ss({source:e,filters:r,session:this.session})}with(...e){let r=this;function n(c){return new Ce({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e})}function a(c){return new Ce({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function i(c,l){return new Ce({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:c}})}function s(c){return new Ba(c,r.session,r.dialect,e)}function o(c){return new La(c,r.session,r.dialect,e)}function p(c){return new Ea(c,r.session,r.dialect,e)}return{select:n,selectDistinct:a,selectDistinctOn:i,update:s,insert:o,delete:p}}select(e){return new Ce({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new Ce({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new Ce({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Ba(e,this.session,this.dialect)}insert(e){return new La(e,this.session,this.dialect)}delete(e){return new Ea(e,this.session,this.dialect)}refreshMaterializedView(e){return new ws(e,this.session,this.dialect)}authToken;execute(e){let r=typeof e=="string"?m.raw(e):e.getSQL(),n=this.dialect.sqlToQuery(r),a=this.session.prepareQuery(n,void 0,void 0,!1);return new Ts(()=>a.execute(void 0,this.authToken),r,n,i=>a.mapResult(i,!0))}transaction(e,r){return this.session.transaction(e,r)}};var Es=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}static[f]="PgPreparedQuery";joinsNotNullableMap},Cs=class{constructor(e){this.dialect=e}static[f]="PgSession";execute(e,r){return ee.startActiveSpan("drizzle.operation",()=>ee.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){let n=await this.execute(e,r);return Number(n[0].count)}},As=class extends yn{constructor(e,r,n,a=0){super(e,r,n),this.schema=n,this.nestedIndex=a}static[f]="PgTransaction";rollback(){throw new ms}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable=="boolean"&&r.push(e.deferrable?"deferrable":"not deferrable"),m.raw(r.join(" "))}setTransaction(e){return this.session.execute(m`set transaction ${this.getTransactionConfigSQL(e)}`)}};var Il=class extends Es{constructor(e,r,n,a,i,s,o){super({sql:r,params:n}),this.client=e,this.queryString=r,this.params=n,this.logger=a,this.fields=i,this._isResponseInArrayMode=s,this.customResultMapper=o}static[f]="PostgresJsPreparedQuery";async execute(e={}){return ee.startActiveSpan("drizzle.execute",async r=>{let n=up(this.params,e);r?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(n)}),this.logger.logQuery(this.queryString,n);let{fields:a,queryString:i,client:s,joinsNotNullableMap:o,customResultMapper:p}=this;if(!a&&!p)return ee.startActiveSpan("drizzle.driver.execute",()=>s.unsafe(i,n));let c=await ee.startActiveSpan("drizzle.driver.execute",()=>(r?.setAttributes({"drizzle.query.text":i,"drizzle.query.params":JSON.stringify(n)}),s.unsafe(i,n).values()));return ee.startActiveSpan("drizzle.mapResponse",()=>p?p(c):c.map(l=>yx(a,l,o)))})}all(e={}){return ee.startActiveSpan("drizzle.execute",async r=>{let n=up(this.params,e);return r?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(n)}),this.logger.logQuery(this.queryString,n),ee.startActiveSpan("drizzle.driver.execute",()=>(r?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(n)}),this.client.unsafe(this.queryString,n)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}},Ma=class t extends Cs{constructor(e,r,n,a={}){super(r),this.client=e,this.schema=n,this.options=a,this.logger=a.logger??new is}static[f]="PostgresJsSession";logger;prepareQuery(e,r,n,a,i){return new Il(this.client,e.sql,e.params,this.logger,r,a,i)}query(e,r){return this.logger.logQuery(e,r),this.client.unsafe(e,r).values()}queryObjects(e,r){return this.client.unsafe(e,r)}transaction(e,r){return this.client.begin(async n=>{let a=new t(n,this.dialect,this.schema,this.options),i=new zl(this.dialect,a,this.schema);return r&&await i.setTransaction(r),e(i)})}},zl=class t extends As{constructor(e,r,n,a=0){super(e,r,n,a),this.session=r}static[f]="PostgresJsTransaction";transaction(e){return this.session.client.savepoint(r=>{let n=new Ma(r,this.dialect,this.schema,this.session.options),a=new t(this.dialect,n,this.schema);return e(a)})}};var $l=class extends yn{static[f]="PostgresJsDatabase"};function bn(t,e={}){let r=p=>p;for(let p of["1184","1082","1083","1114"])t.options.parsers[p]=r,t.options.serializers[p]=r;t.options.serializers[114]=r,t.options.serializers[3802]=r;let n=new Ht({casing:e.casing}),a;e.logger===!0?a=new as:e.logger!==!1&&(a=e.logger);let i;if(e.schema){let p=Sy(e.schema,_y);i={fullSchema:e.schema,schema:p.tables,tableNamesMap:p.tableNamesMap}}let s=new Ma(t,n,i,{logger:a}),o=new $l(n,s,i);return o.$client=t,o}function js(...t){if(typeof t[0]=="string"){let e=(0,Ns.default)(t[0]);return bn(e,t[1])}if(Sx(t[0])){let{connection:e,client:r,...n}=t[0];if(r)return bn(r,n);if(typeof e=="object"&&e.url!==void 0){let{url:i,...s}=e,o=(0,Ns.default)(i,s);return bn(o,n)}let a=(0,Ns.default)(e);return bn(a,n)}return bn(t[0],t[1])}(t=>{function e(r){return bn({options:{parsers:{},serializers:{}}},r)}t.mock=e})(js||(js={}));var My=Or(require("postgres"),1);var B={};Vl(B,{BRAND:()=>_5,DIRTY:()=>vr,EMPTY_PATH:()=>r5,INVALID:()=>O,NEVER:()=>cT,OK:()=>Ae,ParseStatus:()=>ke,Schema:()=>D,ZodAny:()=>Wt,ZodArray:()=>Pt,ZodBigInt:()=>xr,ZodBoolean:()=>yr,ZodBranded:()=>Va,ZodCatch:()=>jr,ZodDate:()=>br,ZodDefault:()=>Nr,ZodDiscriminatedUnion:()=>Os,ZodEffects:()=>nt,ZodEnum:()=>Cr,ZodError:()=>Qe,ZodFirstPartyTypeKind:()=>I,ZodFunction:()=>zs,ZodIntersection:()=>_r,ZodIssueCode:()=>w,ZodLazy:()=>Tr,ZodLiteral:()=>Er,ZodMap:()=>En,ZodNaN:()=>An,ZodNativeEnum:()=>Ar,ZodNever:()=>pt,ZodNull:()=>Sr,ZodNullable:()=>kt,ZodNumber:()=>gr,ZodObject:()=>He,ZodOptional:()=>tt,ZodParsedType:()=>C,ZodPipeline:()=>Qa,ZodPromise:()=>Zt,ZodReadonly:()=>qr,ZodRecord:()=>Is,ZodSchema:()=>D,ZodSet:()=>Cn,ZodString:()=>Kt,ZodSymbol:()=>_n,ZodTransformer:()=>nt,ZodTuple:()=>St,ZodType:()=>D,ZodUndefined:()=>wr,ZodUnion:()=>kr,ZodUnknown:()=>qt,ZodVoid:()=>Tn,addIssueToContext:()=>k,any:()=>O5,array:()=>F5,bigint:()=>A5,boolean:()=>zy,coerce:()=>oT,custom:()=>Py,date:()=>N5,datetimeRegex:()=>jy,defaultErrorMap:()=>Nt,discriminatedUnion:()=>B5,effect:()=>Y5,enum:()=>Z5,function:()=>G5,getErrorMap:()=>wn,getParsedType:()=>wt,instanceof:()=>E5,intersection:()=>M5,isAborted:()=>qs,isAsync:()=>Sn,isDirty:()=>Ps,isValid:()=>Gt,late:()=>T5,lazy:()=>K5,literal:()=>W5,makeIssue:()=>Ua,map:()=>Q5,nan:()=>C5,nativeEnum:()=>J5,never:()=>z5,null:()=>P5,nullable:()=>tT,number:()=>Iy,object:()=>D5,objectUtil:()=>Fl,oboolean:()=>sT,onumber:()=>iT,optional:()=>eT,ostring:()=>aT,pipeline:()=>nT,preprocess:()=>rT,promise:()=>X5,quotelessJson:()=>Y6,record:()=>V5,set:()=>H5,setErrorMap:()=>t5,strictObject:()=>R5,string:()=>Oy,symbol:()=>j5,transformer:()=>Y5,tuple:()=>U5,undefined:()=>q5,union:()=>L5,unknown:()=>I5,util:()=>L,void:()=>$5});var L;(function(t){t.assertEqual=a=>{};function e(a){}t.assertIs=e;function r(a){throw new Error}t.assertNever=r,t.arrayToEnum=a=>{let i={};for(let s of a)i[s]=s;return i},t.getValidEnumValues=a=>{let i=t.objectKeys(a).filter(o=>typeof a[a[o]]!="number"),s={};for(let o of i)s[o]=a[o];return t.objectValues(s)},t.objectValues=a=>t.objectKeys(a).map(function(i){return a[i]}),t.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{let i=[];for(let s in a)Object.prototype.hasOwnProperty.call(a,s)&&i.push(s);return i},t.find=(a,i)=>{for(let s of a)if(i(s))return s},t.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function n(a,i=" | "){return a.map(s=>typeof s=="string"?`'${s}'`:s).join(i)}t.joinValues=n,t.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(L||(L={}));var Fl;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(Fl||(Fl={}));var C=L.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),wt=t=>{switch(typeof t){case"undefined":return C.undefined;case"string":return C.string;case"number":return Number.isNaN(t)?C.nan:C.number;case"boolean":return C.boolean;case"function":return C.function;case"bigint":return C.bigint;case"symbol":return C.symbol;case"object":return Array.isArray(t)?C.array:t===null?C.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?C.promise:typeof Map<"u"&&t instanceof Map?C.map:typeof Set<"u"&&t instanceof Set?C.set:typeof Date<"u"&&t instanceof Date?C.date:C.object;default:return C.unknown}};var w=L.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Y6=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),Qe=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(i){return i.message},n={_errors:[]},a=i=>{for(let s of i.issues)if(s.code==="invalid_union")s.unionErrors.map(a);else if(s.code==="invalid_return_type")a(s.returnTypeError);else if(s.code==="invalid_arguments")a(s.argumentsError);else if(s.path.length===0)n._errors.push(r(s));else{let o=n,p=0;for(;p<s.path.length;){let c=s.path[p];p===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],p++}}};return a(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,L.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let a of this.issues)if(a.path.length>0){let i=a.path[0];r[i]=r[i]||[],r[i].push(e(a))}else n.push(e(a));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};Qe.create=t=>new Qe(t);var e5=(t,e)=>{let r;switch(t.code){case w.invalid_type:t.received===C.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case w.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,L.jsonStringifyReplacer)}`;break;case w.unrecognized_keys:r=`Unrecognized key(s) in object: ${L.joinValues(t.keys,", ")}`;break;case w.invalid_union:r="Invalid input";break;case w.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${L.joinValues(t.options)}`;break;case w.invalid_enum_value:r=`Invalid enum value. Expected ${L.joinValues(t.options)}, received '${t.received}'`;break;case w.invalid_arguments:r="Invalid function arguments";break;case w.invalid_return_type:r="Invalid function return type";break;case w.invalid_date:r="Invalid date";break;case w.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:L.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case w.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case w.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case w.custom:r="Invalid input";break;case w.invalid_intersection_types:r="Intersection results could not be merged";break;case w.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case w.not_finite:r="Number must be finite";break;default:r=e.defaultError,L.assertNever(t)}return{message:r}},Nt=e5;var Ty=Nt;function t5(t){Ty=t}function wn(){return Ty}var Ua=t=>{let{data:e,path:r,errorMaps:n,issueData:a}=t,i=[...r,...a.path||[]],s={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let o="",p=n.filter(c=>!!c).slice().reverse();for(let c of p)o=c(s,{data:e,defaultError:o}).message;return{...a,path:i,message:o}},r5=[];function k(t,e){let r=wn(),n=Ua({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===Nt?void 0:Nt].filter(a=>!!a)});t.common.issues.push(n)}var ke=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let n=[];for(let a of r){if(a.status==="aborted")return O;a.status==="dirty"&&e.dirty(),n.push(a.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let a of r){let i=await a.key,s=await a.value;n.push({key:i,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let a of r){let{key:i,value:s}=a;if(i.status==="aborted"||s.status==="aborted")return O;i.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof s.value<"u"||a.alwaysSet)&&(n[i.value]=s.value)}return{status:e.value,value:n}}},O=Object.freeze({status:"aborted"}),vr=t=>({status:"dirty",value:t}),Ae=t=>({status:"valid",value:t}),qs=t=>t.status==="aborted",Ps=t=>t.status==="dirty",Gt=t=>t.status==="valid",Sn=t=>typeof Promise<"u"&&t instanceof Promise;var j;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(j||(j={}));var rt=class{constructor(e,r,n,a){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Ey=(t,e)=>{if(Gt(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new Qe(t.common.issues);return this._error=r,this._error}}};function F(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:a}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(s,o)=>{let{message:p}=t;return s.code==="invalid_enum_value"?{message:p??o.defaultError}:typeof o.data>"u"?{message:p??n??o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:p??r??o.defaultError}},description:a}}var D=class{get description(){return this._def.description}_getType(e){return wt(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:wt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ke,ctx:{common:e.parent.common,data:e.data,parsedType:wt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Sn(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:wt(e)},a=this._parseSync({data:e,path:n.path,parent:n});return Ey(n,a)}"~validate"(e){let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:wt(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return Gt(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>Gt(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:wt(e)},a=this._parse({data:e,path:n.path,parent:n}),i=await(Sn(a)?a:Promise.resolve(a));return Ey(n,i)}refine(e,r){let n=a=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(a):r;return this._refinement((a,i)=>{let s=e(a),o=()=>i.addIssue({code:w.custom,...n(a)});return typeof Promise<"u"&&s instanceof Promise?s.then(p=>p?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((n,a)=>e(n)?!0:(a.addIssue(typeof r=="function"?r(n,a):r),!1))}_refinement(e){return new nt({schema:this,typeName:I.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return tt.create(this,this._def)}nullable(){return kt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Pt.create(this)}promise(){return Zt.create(this,this._def)}or(e){return kr.create([this,e],this._def)}and(e){return _r.create(this,e,this._def)}transform(e){return new nt({...F(this._def),schema:this,typeName:I.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new Nr({...F(this._def),innerType:this,defaultValue:r,typeName:I.ZodDefault})}brand(){return new Va({typeName:I.ZodBranded,type:this,...F(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new jr({...F(this._def),innerType:this,catchValue:r,typeName:I.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return Qa.create(this,e)}readonly(){return qr.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},n5=/^c[^\s-]{8,}$/i,a5=/^[0-9a-z]+$/,i5=/^[0-9A-HJKMNP-TV-Z]{26}$/i,s5=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,o5=/^[a-z0-9_-]{21}$/i,c5=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,p5=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,l5=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,u5="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Dl,d5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,f5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,m5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,h5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,v5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,g5=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Ay="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",x5=new RegExp(`^${Ay}$`);function Ny(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);let r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function y5(t){return new RegExp(`^${Ny(t)}$`)}function jy(t){let e=`${Ay}T${Ny(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function b5(t,e){return!!((e==="v4"||!e)&&d5.test(t)||(e==="v6"||!e)&&m5.test(t))}function w5(t,e){if(!c5.test(t))return!1;try{let[r]=t.split(".");if(!r)return!1;let n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),a=JSON.parse(atob(n));return!(typeof a!="object"||a===null||"typ"in a&&a?.typ!=="JWT"||!a.alg||e&&a.alg!==e)}catch{return!1}}function S5(t,e){return!!((e==="v4"||!e)&&f5.test(t)||(e==="v6"||!e)&&h5.test(t))}var Kt=class t extends D{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==C.string){let i=this._getOrReturnCtx(e);return k(i,{code:w.invalid_type,expected:C.string,received:i.parsedType}),O}let n=new ke,a;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(a=this._getOrReturnCtx(e,a),k(a,{code:w.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(a=this._getOrReturnCtx(e,a),k(a,{code:w.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){let s=e.data.length>i.value,o=e.data.length<i.value;(s||o)&&(a=this._getOrReturnCtx(e,a),s?k(a,{code:w.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&k(a,{code:w.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")l5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"email",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")Dl||(Dl=new RegExp(u5,"u")),Dl.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"emoji",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")s5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"uuid",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")o5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"nanoid",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")n5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"cuid",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")a5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"cuid2",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")i5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"ulid",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),k(a,{validation:"url",code:w.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"regex",code:w.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(e,a),k(a,{code:w.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(a=this._getOrReturnCtx(e,a),k(a,{code:w.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(a=this._getOrReturnCtx(e,a),k(a,{code:w.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?jy(i).test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{code:w.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?x5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{code:w.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?y5(i).test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{code:w.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?p5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"duration",code:w.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?b5(e.data,i.version)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"ip",code:w.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?w5(e.data,i.alg)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"jwt",code:w.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?S5(e.data,i.version)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"cidr",code:w.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?v5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"base64",code:w.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?g5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"base64url",code:w.invalid_string,message:i.message}),n.dirty()):L.assertNever(i);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(a=>e.test(a),{validation:r,code:w.invalid_string,...j.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...j.errToObj(e)})}url(e){return this._addCheck({kind:"url",...j.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...j.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...j.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...j.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...j.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...j.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...j.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...j.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...j.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...j.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...j.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...j.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...j.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...j.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...j.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...j.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...j.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...j.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...j.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...j.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...j.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...j.errToObj(r)})}nonempty(e){return this.min(1,j.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Kt.create=t=>new Kt({checks:[],typeName:I.ZodString,coerce:t?.coerce??!1,...F(t)});function k5(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,a=r>n?r:n,i=Number.parseInt(t.toFixed(a).replace(".","")),s=Number.parseInt(e.toFixed(a).replace(".",""));return i%s/10**a}var gr=class t extends D{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==C.number){let i=this._getOrReturnCtx(e);return k(i,{code:w.invalid_type,expected:C.number,received:i.parsedType}),O}let n,a=new ke;for(let i of this._def.checks)i.kind==="int"?L.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:w.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:w.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:w.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?k5(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),k(n,{code:w.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:w.not_finite,message:i.message}),a.dirty()):L.assertNever(i);return{status:a.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,j.toString(r))}gt(e,r){return this.setLimit("min",e,!1,j.toString(r))}lte(e,r){return this.setLimit("max",e,!0,j.toString(r))}lt(e,r){return this.setLimit("max",e,!1,j.toString(r))}setLimit(e,r,n,a){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:j.toString(a)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:j.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:j.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:j.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:j.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:j.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:j.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:j.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:j.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:j.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&L.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}};gr.create=t=>new gr({checks:[],typeName:I.ZodNumber,coerce:t?.coerce||!1,...F(t)});var xr=class t extends D{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==C.bigint)return this._getInvalidInput(e);let n,a=new ke;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:w.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:w.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),k(n,{code:w.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):L.assertNever(i);return{status:a.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return k(r,{code:w.invalid_type,expected:C.bigint,received:r.parsedType}),O}gte(e,r){return this.setLimit("min",e,!0,j.toString(r))}gt(e,r){return this.setLimit("min",e,!1,j.toString(r))}lte(e,r){return this.setLimit("max",e,!0,j.toString(r))}lt(e,r){return this.setLimit("max",e,!1,j.toString(r))}setLimit(e,r,n,a){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:j.toString(a)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:j.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:j.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:j.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive
2026-01-08T14:30:02.770167139Z ==> Running 'npm run start'
2026-01-08T14:30:03.765921802Z 
2026-01-08T14:30:03.765955124Z > rest-express@1.0.0 start
2026-01-08T14:30:03.765962154Z > NODE_ENV=production node dist/index.cjs
2026-01-08T14:30:03.765966124Z 
2026-01-08T14:30:04.565817363Z /opt/render/project/src/dist/index.cjs:69
2026-01-08T14:30:04.565870656Z 		`;await r.execute(m`CREATE SCHEMA IF NOT EXISTS ${m.identifier(i)}`),await r.execute(s);let p=(await r.all(m`select id, hash, created_at from ${m.identifier(i)}.${m.identifier(a)} order by created_at desc limit 1`))[0];await r.transaction(async c=>{for await(let l of e)if(!p||Number(p.created_at)<l.folderMillis){for(let u of l.sql)await c.execute(m.raw(u));await c.execute(m`insert into ${m.identifier(i)}.${m.identifier(a)} ("hash", "created_at") values(${l.hash}, ${l.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let r=[m`with `];for(let[n,a]of e.entries())r.push(m`${m.identifier(a._.alias)} as (${a._.sql})`),n<e.length-1&&r.push(m`, `);return r.push(m` `),m.join(r)}buildDeleteQuery({table:e,where:r,returning:n,withList:a}){let i=this.buildWithCTE(a),s=n?m` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,o=r?m` where ${r}`:void 0;return m`${i}delete from ${e}${o}${s}`}buildUpdateSet(e,r){let n=e[T.Symbol.Columns],a=Object.keys(n).filter(s=>r[s]!==void 0||n[s]?.onUpdateFn!==void 0),i=a.length;return m.join(a.flatMap((s,o)=>{let p=n[s],c=r[s]??m.param(p.onUpdateFn(),p),l=m`${m.identifier(this.casing.getColumnCasing(p))} = ${c}`;return o<i-1?[l,m.raw(", ")]:[l]}))}buildUpdateQuery({table:e,set:r,where:n,returning:a,withList:i,from:s,joins:o}){let p=this.buildWithCTE(i),c=e[Se.Symbol.Name],l=e[Se.Symbol.Schema],u=e[Se.Symbol.OriginalName],d=c===u?void 0:c,h=m`${l?m`${m.identifier(l)}.`:void 0}${m.identifier(u)}${d&&m` ${m.identifier(d)}`}`,v=this.buildUpdateSet(e,r),g=s&&m.join([m.raw(" from "),this.buildFromTable(s)]),b=this.buildJoins(o),E=a?m` returning ${this.buildSelection(a,{isSingleTable:!s})}`:void 0,q=n?m` where ${n}`:void 0;return m`${p}update ${h} set ${v}${g}${b}${q}${E}`}buildSelection(e,{isSingleTable:r=!1}={}){let n=e.length,a=e.flatMap(({field:i},s)=>{let o=[];if(y(i,A.Aliased)&&i.isSelectionField)o.push(m.identifier(i.fieldAlias));else if(y(i,A.Aliased)||y(i,A)){let p=y(i,A.Aliased)?i.sql:i;r?o.push(new A(p.queryChunks.map(c=>y(c,S)?m.identifier(this.casing.getColumnCasing(c)):c))):o.push(p),y(i,A.Aliased)&&o.push(m` as ${m.identifier(i.fieldAlias)}`)}else y(i,H)&&(r?o.push(m.identifier(this.casing.getColumnCasing(i))):o.push(i));return s<n-1&&o.push(m`, `),o});return m.join(a)}buildJoins(e){if(!e||e.length===0)return;let r=[];for(let[n,a]of e.entries()){n===0&&r.push(m` `);let i=a.table,s=a.lateral?m` lateral`:void 0;if(y(i,Se)){let o=i[Se.Symbol.Name],p=i[Se.Symbol.Schema],c=i[Se.Symbol.OriginalName],l=o===c?void 0:a.alias;r.push(m`${m.raw(a.joinType)} join${s} ${p?m`${m.identifier(p)}.`:void 0}${m.identifier(c)}${l&&m` ${m.identifier(l)}`} on ${a.on}`)}else if(y(i,ze)){let o=i[te].name,p=i[te].schema,c=i[te].originalName,l=o===c?void 0:a.alias;r.push(m`${m.raw(a.joinType)} join${s} ${p?m`${m.identifier(p)}.`:void 0}${m.identifier(c)}${l&&m` ${m.identifier(l)}`} on ${a.on}`)}else r.push(m`${m.raw(a.joinType)} join${s} ${i} on ${a.on}`);n<e.length-1&&r.push(m` `)}return m.join(r)}buildFromTable(e){if(y(e,T)&&e[T.Symbol.OriginalName]!==e[T.Symbol.Name]){let r=m`${m.identifier(e[T.Symbol.OriginalName])}`;return e[T.Symbol.Schema]&&(r=m`${m.identifier(e[T.Symbol.Schema])}.${r}`),m`${r} ${m.identifier(e[T.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:n,where:a,having:i,table:s,joins:o,orderBy:p,groupBy:c,limit:l,offset:u,lockingClause:d,distinct:h,setOperators:v}){let g=n??et(r);for(let se of g)if(y(se.field,H)&&Be(se.field.table)!==(y(s,fe)?s._.alias:y(s,vn)?s[te].name:y(s,A)?void 0:Be(s))&&!(ve=>o?.some(({alias:_t})=>_t===(ve[T.Symbol.IsAlias]?Be(ve):ve[T.Symbol.BaseName])))(se.field.table)){let ve=Be(se.field.table);throw new Error(`Your "${se.path.join("->")}" field references a column "${ve}"."${se.field.name}", but the table "${ve}" is not part of the query! Did you forget to join it?`)}let b=!o||o.length===0,E=this.buildWithCTE(e),q;h&&(q=h===!0?m` distinct`:m` distinct on (${m.join(h.on,m`, `)})`);let _=this.buildSelection(g,{isSingleTable:b}),z=this.buildFromTable(s),V=this.buildJoins(o),R=a?m` where ${a}`:void 0,P=i?m` having ${i}`:void 0,$;p&&p.length>0&&($=m` order by ${m.join(p,m`, `)}`);let ne;c&&c.length>0&&(ne=m` group by ${m.join(c,m`, `)}`);let Ne=typeof l=="object"||typeof l=="number"&&l>=0?m` limit ${l}`:void 0,at=u?m` offset ${u}`:void 0,Ge=m.empty();if(d){let se=m` for ${m.raw(d.strength)}`;d.config.of&&se.append(m` of ${m.join(Array.isArray(d.config.of)?d.config.of:[d.config.of],m`, `)}`),d.config.noWait?se.append(m` no wait`):d.config.skipLocked&&se.append(m` skip locked`),Ge.append(se)}let ue=m`${E}select${q} ${_} from ${z}${V}${R}${ne}${P}${$}${Ne}${at}${Ge}`;return v.length>0?this.buildSetOperations(ue,v):ue}buildSetOperations(e,r){let[n,...a]=r;if(!n)throw new Error("Cannot pass undefined values to any set operator");return a.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),a)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:n,rightSelect:a,limit:i,orderBy:s,offset:o}}){let p=m`(${e.getSQL()}) `,c=m`(${a.getSQL()})`,l;if(s&&s.length>0){let v=[];for(let g of s)if(y(g,S))v.push(m.identifier(g.name));else if(y(g,A)){for(let b=0;b<g.queryChunks.length;b++){let E=g.queryChunks[b];y(E,S)&&(g.queryChunks[b]=m.identifier(E.name))}v.push(m`${g}`)}else v.push(m`${g}`);l=m` order by ${m.join(v,m`, `)} `}let u=typeof i=="object"||typeof i=="number"&&i>=0?m` limit ${i}`:void 0,d=m.raw(`${r} ${n?"all ":""}`),h=o?m` offset ${o}`:void 0;return m`${p}${d}${c}${l}${u}${h}`}buildInsertQuery({table:e,values:r,onConflict:n,returning:a,withList:i,select:s,overridingSystemValue_:o}){let p=[],c=e[T.Symbol.Columns],l=Object.entries(c).filter(([E,q])=>!q.shouldDisableInsert()),u=l.map(([,E])=>m.identifier(this.casing.getColumnCasing(E)));if(s){let E=r;y(E,A)?p.push(E):p.push(E.getSQL())}else{let E=r;p.push(m.raw("values "));for(let[q,_]of E.entries()){let z=[];for(let[V,R]of l){let P=_[V];if(P===void 0||y(P,Me)&&P.value===void 0)if(R.defaultFn!==void 0){let $=R.defaultFn(),ne=y($,A)?$:m.param($,R);z.push(ne)}else if(!R.default&&R.onUpdateFn!==void 0){let $=R.onUpdateFn(),ne=y($,A)?$:m.param($,R);z.push(ne)}else z.push(m`default`);else z.push(P)}p.push(z),q<E.length-1&&p.push(m`, `)}}let d=this.buildWithCTE(i),h=m.join(p),v=a?m` returning ${this.buildSelection(a,{isSingleTable:!0})}`:void 0,g=n?m` on conflict ${n}`:void 0,b=o===!0?m`overriding system value `:void 0;return m`${d}insert into ${e} ${u} ${b}${h}${g}${v}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:n}){let a=r?m` concurrently`:void 0,i=n?m` with no data`:void 0;return m`refresh materialized view${a} ${e}${i}`}prepareTyping(e){return y(e,qa)||y(e,ja)?"json":y(e,Pa)?"decimal":y(e,Oa)?"time":y(e,Ia)||y(e,za)?"timestamp":y(e,Aa)||y(e,Na)?"date":y(e,$a)?"uuid":"none"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:a,tableConfig:i,queryConfig:s,tableAlias:o,nestedQueryRelation:p,joinOn:c}){let l=[],u,d,h=[],v,g=[];if(s===!0)l=Object.entries(i.columns).map(([q,_])=>({dbKey:_.name,tsKey:q,field:xt(_,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let E=Object.fromEntries(Object.entries(i.columns).map(([P,$])=>[P,xt($,o)]));if(s.where){let P=typeof s.where=="function"?s.where(E,by()):s.where;v=P&&_a(P,o)}let q=[],_=[];if(s.columns){let P=!1;for(let[$,ne]of Object.entries(s.columns))ne!==void 0&&$ in i.columns&&(!P&&ne===!0&&(P=!0),_.push($));_.length>0&&(_=P?_.filter($=>s.columns?.[$]===!0):Object.keys(i.columns).filter($=>!_.includes($)))}else _=Object.keys(i.columns);for(let P of _){let $=i.columns[P];q.push({tsKey:P,value:$})}let z=[];s.with&&(z=Object.entries(s.with).filter(P=>!!P[1]).map(([P,$])=>({tsKey:P,queryConfig:$,relation:i.relations[P]})));let V;if(s.extras){V=typeof s.extras=="function"?s.extras(E,{sql:m}):s.extras;for(let[P,$]of Object.entries(V))q.push({tsKey:P,value:dp($,o)})}for(let{tsKey:P,value:$}of q)l.push({dbKey:y($,A.Aliased)?$.fieldAlias:i.columns[P].name,tsKey:P,field:y($,H)?xt($,o):$,relationTableTsKey:void 0,isJson:!1,selection:[]});let R=typeof s.orderBy=="function"?s.orderBy(E,wy()):s.orderBy??[];Array.isArray(R)||(R=[R]),h=R.map(P=>y(P,H)?xt(P,o):_a(P,o)),u=s.limit,d=s.offset;for(let{tsKey:P,queryConfig:$,relation:ne}of z){let Ne=ky(r,n,ne),at=fr(ne.referencedTable),Ge=n[at],ue=`${o}_${P}`,se=Da(...Ne.fields.map((jn,Fs)=>Ze(xt(Ne.references[Fs],ue),xt(jn,o)))),ve=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:e[Ge],tableConfig:r[Ge],queryConfig:y(ne,Qt)?$===!0?{limit:1}:{...$,limit:1}:$,tableAlias:ue,joinOn:se,nestedQueryRelation:ne}),_t=m`${m.identifier(ue)}.${m.identifier("data")}`.as(P);g.push({on:m`true`,table:new fe(ve.sql,{},ue),alias:ue,joinType:"left",lateral:!0}),l.push({dbKey:P,tsKey:P,field:_t,relationTableTsKey:Ge,isJson:!0,selection:ve.selection})}}if(l.length===0)throw new Ca({message:`No fields selected for table "${i.tsName}" ("${o}")`});let b;if(v=Da(c,v),p){let E=m`json_build_array(${m.join(l.map(({field:z,tsKey:V,isJson:R})=>R?m`${m.identifier(`${o}_${V}`)}.${m.identifier("data")}`:y(z,A.Aliased)?z.sql:z),m`, `)})`;y(p,Ra)&&(E=m`coalesce(json_agg(${E}${h.length>0?m` order by ${m.join(h,m`, `)}`:void 0}), '[]'::json)`);let q=[{dbKey:"data",tsKey:"data",field:E.as("data"),isJson:!0,relationTableTsKey:i.tsName,selection:l}];u!==void 0||d!==void 0||h.length>0?(b=this.buildSelectQuery({table:ka(a,o),fields:{},fieldsFlat:[{path:[],field:m.raw("*")}],where:v,limit:u,offset:d,orderBy:h,setOperators:[]}),v=void 0,u=void 0,d=void 0,h=[]):b=ka(a,o),b=this.buildSelectQuery({table:y(b,Se)?b:new fe(b,{},o),fields:{},fieldsFlat:q.map(({field:z})=>({path:[],field:y(z,H)?xt(z,o):z})),joins:g,where:v,limit:u,offset:d,orderBy:h,setOperators:[]})}else b=this.buildSelectQuery({table:ka(a,o),fields:{},fieldsFlat:l.map(({field:E})=>({path:[],field:y(E,H)?xt(E,o):E})),joins:g,where:v,limit:u,offset:d,orderBy:h,setOperators:[]});return{tableTsKey:i.tsName,sql:b,selection:l}}};var xs=class{static[f]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}};var Ce=class{static[f]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let r=!!this.fields,n=e,a;return this.fields?a=this.fields:y(n,fe)?a=Object.fromEntries(Object.keys(n._.selectedFields).map(i=>[i,n[i]])):y(n,vn)?a=n[te].selectedFields:y(n,A)?a={}:a=ds(n),new ys({table:n,fields:a,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},Pl=class extends xs{static[f]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:n,session:a,dialect:i,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...r},distinct:o,setOperators:[]},this.isPartialSelect=n,this.session=a,this.dialect=i,this._={selectedFields:r},this.tableName=Ct(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}createJoin(e){return(r,n)=>{let a=this.tableName,i=Ct(r);if(typeof i=="string"&&this.config.joins?.some(s=>s.alias===i))throw new Error(`Alias "${i}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof a=="string"&&(this.config.fields={[a]:this.config.fields}),typeof i=="string"&&!y(r,A))){let s=y(r,fe)?r._.selectedFields:y(r,ze)?r[te].selectedFields:r[T.Symbol.Columns];this.config.fields[i]=s}if(typeof n=="function"&&(n=n(new Proxy(this.config.fields,new pe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:r,joinType:e,alias:i}),typeof i=="string")switch(e){case"left":{this.joinsNotNullableMap[i]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[i]=!0;break}case"inner":{this.joinsNotNullableMap[i]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,r){return n=>{let a=typeof n=="function"?n(H6()):n;if(!Ta(this.getSelectedFields(),a.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:r,rightSelect:a}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new pe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new pe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new pe({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new pe({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),n=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new fe(this.getSQL(),this.config.fields,e),new pe({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new pe({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}},ys=class extends Pl{static[f]="PgSelect";_prepare(e){let{session:r,config:n,dialect:a,joinsNotNullableMap:i,authToken:s}=this;if(!r)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return ee.startActiveSpan("drizzle.prepareQuery",()=>{let o=et(n.fields),p=r.prepareQuery(a.sqlToQuery(this.getSQL()),o,e,!0);return p.joinsNotNullableMap=i,p.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};bx(ys,[Ee]);function gn(t,e){return(r,n,...a)=>{let i=[n,...a].map(s=>({type:t,isAll:e,rightSelect:s}));for(let s of i)if(!Ta(r.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return r.addSetOperators(i)}}var H6=()=>({union:G6,unionAll:K6,intersect:W6,intersectAll:Z6,except:J6,exceptAll:X6}),G6=gn("union",!1),K6=gn("union",!0),W6=gn("intersect",!1),Z6=gn("intersect",!0),J6=gn("except",!1),X6=gn("except",!0);var xn=class{static[f]="PgQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=y(e,Ht)?e:void 0,this.dialectConfig=y(e,Ht)?void 0:e}$with=(e,r)=>{let n=this;return{as:i=>(typeof i=="function"&&(i=i(n)),new Proxy(new mn(i.getSQL(),r??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new pe({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...e){let r=this;function n(s){return new Ce({fields:s??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function a(s){return new Ce({fields:s??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function i(s,o){return new Ce({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:s}})}return{select:n,selectDistinct:a,selectDistinctOn:i}}select(e){return new Ce({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new Ce({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new Ce({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new Ht(this.dialectConfig)),this.dialect}};var La=class{constructor(e,r,n,a,i){this.table=e,this.session=r,this.dialect=n,this.withList=a,this.overridingSystemValue_=i}static[f]="PgInsertBuilder";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error("values() must be called with at least one value");let r=e.map(n=>{let a={},i=this.table[T.Symbol.Columns];for(let s of Object.keys(n)){let o=n[s];a[s]=y(o,A)?o:new Me(o,i[s])}return a});return new bs(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let r=typeof e=="function"?e(new xn):e;if(!y(r,A)&&!Ta(this.table[ls],r._.selectedFields))throw new Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new bs(this.table,r,this.session,this.dialect,this.withList,!0)}},bs=class extends Ee{constructor(e,r,n,a,i,s,o){super(),this.session=n,this.dialect=a,this.config={table:e,values:r,withList:i,select:s,overridingSystemValue_:o}}static[f]="PgInsert";config;returning(e=this.config.table[T.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=et(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=m`do nothing`;else{let r="";r=Array.isArray(e.target)?e.target.map(a=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(a))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let n=e.where?m` where ${e.where}`:void 0;this.config.onConflict=m`(${m.raw(r)})${n} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let r=e.where?m` where ${e.where}`:void 0,n=e.targetWhere?m` where ${e.targetWhere}`:void 0,a=e.setWhere?m` where ${e.setWhere}`:void 0,i=this.dialect.buildUpdateSet(this.config.table,us(this.config.table,e.set)),s="";return s=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=m`(${m.raw(s)})${n} do update set ${i}${r}${a}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new pe({alias:Be(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var ws=class extends Ee{constructor(e,r,n){super(),this.session=r,this.dialect=n,this.config={view:e}}static[f]="PgRefreshMaterializedView";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return ee.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ee.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};var Ba=class{constructor(e,r,n,a){this.table=e,this.session=r,this.dialect=n,this.withList=a}static[f]="PgUpdateBuilder";authToken;setToken(e){return this.authToken=e,this}set(e){return new Ol(this.table,us(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Ol=class extends Ee{constructor(e,r,n,a,i){super(),this.session=n,this.dialect=a,this.config={set:r,table:e,withList:i,joins:[]},this.tableName=Ct(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}static[f]="PgUpdate";config;tableName;joinsNotNullableMap;from(e){let r=e,n=Ct(r);return typeof n=="string"&&(this.joinsNotNullableMap[n]=!0),this.config.from=r,this}getTableLikeFields(e){return y(e,Se)?e[T.Symbol.Columns]:y(e,fe)?e._.selectedFields:e[te].selectedFields}createJoin(e){return(r,n)=>{let a=Ct(r);if(typeof a=="string"&&this.config.joins.some(i=>i.alias===a))throw new Error(`Alias "${a}" is already used in this query`);if(typeof n=="function"){let i=this.config.from&&!y(this.config.from,A)?this.getTableLikeFields(this.config.from):void 0;n=n(new Proxy(this.config.table[T.Symbol.Columns],new pe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),i&&new Proxy(i,new pe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:n,table:r,joinType:e,alias:a}),typeof a=="string")switch(e){case"left":{this.joinsNotNullableMap[a]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([i])=>[i,!1])),this.joinsNotNullableMap[a]=!0;break}case"inner":{this.joinsNotNullableMap[a]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([i])=>[i,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[T.Symbol.Columns]),this.config.from)){let r=Ct(this.config.from);if(typeof r=="string"&&this.config.from&&!y(this.config.from,A)){let n=this.getTableLikeFields(this.config.from);e[r]=n}for(let n of this.config.joins){let a=Ct(n.table);if(typeof a=="string"&&!y(n.table,A)){let i=this.getTableLikeFields(n.table);e[a]=i}}}return this.config.returningFields=e,this.config.returning=et(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){let r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new pe({alias:Be(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var Ss=class t extends A{constructor(e){super(t.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=t.buildCount(e.source,e.filters)}sql;token;static[f]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(e,r){return m`(select count(*) from ${e}${m.raw(" where ").if(r)}${r})`}static buildCount(e,r){return m`select count(*) as count from ${e}${m.raw(" where ").if(r)}${r};`}setToken(e){return this.token=e,this}then(e,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,r)}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}};var ks=class{constructor(e,r,n,a,i,s,o){this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=a,this.tableConfig=i,this.dialect=s,this.session=o}static[f]="PgRelationalQueryBuilder";findMany(e){return new _s(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new _s(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}},_s=class extends Ee{constructor(e,r,n,a,i,s,o,p,c){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=a,this.tableConfig=i,this.dialect=s,this.session=o,this.config=p,this.mode=c}static[f]="PgRelationalQuery";_prepare(e){return ee.startActiveSpan("drizzle.prepareQuery",()=>{let{query:r,builtQuery:n}=this._toSQL();return this.session.prepareQuery(n,void 0,e,!0,(a,i)=>{let s=a.map(o=>gs(this.schema,this.tableConfig,o,r.selection,i));return this.mode==="first"?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ee.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}};var Ts=class extends Ee{constructor(e,r,n,a){super(),this.execute=e,this.sql=r,this.query=n,this.mapBatchResult=a}static[f]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var yn=class{constructor(e,r,n){if(this.dialect=e,this.session=r,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[a,i]of Object.entries(this._.schema))this.query[a]=new ks(n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[a],i,e,r)}static[f]="PgDatabase";query;$with=(e,r)=>{let n=this;return{as:i=>(typeof i=="function"&&(i=i(new xn(n.dialect))),new Proxy(new mn(i.getSQL(),r??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new pe({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(e,r){return new Ss({source:e,filters:r,session:this.session})}with(...e){let r=this;function n(c){return new Ce({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e})}function a(c){return new Ce({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function i(c,l){return new Ce({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:c}})}function s(c){return new Ba(c,r.session,r.dialect,e)}function o(c){return new La(c,r.session,r.dialect,e)}function p(c){return new Ea(c,r.session,r.dialect,e)}return{select:n,selectDistinct:a,selectDistinctOn:i,update:s,insert:o,delete:p}}select(e){return new Ce({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new Ce({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new Ce({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Ba(e,this.session,this.dialect)}insert(e){return new La(e,this.session,this.dialect)}delete(e){return new Ea(e,this.session,this.dialect)}refreshMaterializedView(e){return new ws(e,this.session,this.dialect)}authToken;execute(e){let r=typeof e=="string"?m.raw(e):e.getSQL(),n=this.dialect.sqlToQuery(r),a=this.session.prepareQuery(n,void 0,void 0,!1);return new Ts(()=>a.execute(void 0,this.authToken),r,n,i=>a.mapResult(i,!0))}transaction(e,r){return this.session.transaction(e,r)}};var Es=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}static[f]="PgPreparedQuery";joinsNotNullableMap},Cs=class{constructor(e){this.dialect=e}static[f]="PgSession";execute(e,r){return ee.startActiveSpan("drizzle.operation",()=>ee.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){let n=await this.execute(e,r);return Number(n[0].count)}},As=class extends yn{constructor(e,r,n,a=0){super(e,r,n),this.schema=n,this.nestedIndex=a}static[f]="PgTransaction";rollback(){throw new ms}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable=="boolean"&&r.push(e.deferrable?"deferrable":"not deferrable"),m.raw(r.join(" "))}setTransaction(e){return this.session.execute(m`set transaction ${this.getTransactionConfigSQL(e)}`)}};var Il=class extends Es{constructor(e,r,n,a,i,s,o){super({sql:r,params:n}),this.client=e,this.queryString=r,this.params=n,this.logger=a,this.fields=i,this._isResponseInArrayMode=s,this.customResultMapper=o}static[f]="PostgresJsPreparedQuery";async execute(e={}){return ee.startActiveSpan("drizzle.execute",async r=>{let n=up(this.params,e);r?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(n)}),this.logger.logQuery(this.queryString,n);let{fields:a,queryString:i,client:s,joinsNotNullableMap:o,customResultMapper:p}=this;if(!a&&!p)return ee.startActiveSpan("drizzle.driver.execute",()=>s.unsafe(i,n));let c=await ee.startActiveSpan("drizzle.driver.execute",()=>(r?.setAttributes({"drizzle.query.text":i,"drizzle.query.params":JSON.stringify(n)}),s.unsafe(i,n).values()));return ee.startActiveSpan("drizzle.mapResponse",()=>p?p(c):c.map(l=>yx(a,l,o)))})}all(e={}){return ee.startActiveSpan("drizzle.execute",async r=>{let n=up(this.params,e);return r?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(n)}),this.logger.logQuery(this.queryString,n),ee.startActiveSpan("drizzle.driver.execute",()=>(r?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(n)}),this.client.unsafe(this.queryString,n)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}},Ma=class t extends Cs{constructor(e,r,n,a={}){super(r),this.client=e,this.schema=n,this.options=a,this.logger=a.logger??new is}static[f]="PostgresJsSession";logger;prepareQuery(e,r,n,a,i){return new Il(this.client,e.sql,e.params,this.logger,r,a,i)}query(e,r){return this.logger.logQuery(e,r),this.client.unsafe(e,r).values()}queryObjects(e,r){return this.client.unsafe(e,r)}transaction(e,r){return this.client.begin(async n=>{let a=new t(n,this.dialect,this.schema,this.options),i=new zl(this.dialect,a,this.schema);return r&&await i.setTransaction(r),e(i)})}},zl=class t extends As{constructor(e,r,n,a=0){super(e,r,n,a),this.session=r}static[f]="PostgresJsTransaction";transaction(e){return this.session.client.savepoint(r=>{let n=new Ma(r,this.dialect,this.schema,this.session.options),a=new t(this.dialect,n,this.schema);return e(a)})}};var $l=class extends yn{static[f]="PostgresJsDatabase"};function bn(t,e={}){let r=p=>p;for(let p of["1184","1082","1083","1114"])t.options.parsers[p]=r,t.options.serializers[p]=r;t.options.serializers[114]=r,t.options.serializers[3802]=r;let n=new Ht({casing:e.casing}),a;e.logger===!0?a=new as:e.logger!==!1&&(a=e.logger);let i;if(e.schema){let p=Sy(e.schema,_y);i={fullSchema:e.schema,schema:p.tables,tableNamesMap:p.tableNamesMap}}let s=new Ma(t,n,i,{logger:a}),o=new $l(n,s,i);return o.$client=t,o}function js(...t){if(typeof t[0]=="string"){let e=(0,Ns.default)(t[0]);return bn(e,t[1])}if(Sx(t[0])){let{connection:e,client:r,...n}=t[0];if(r)return bn(r,n);if(typeof e=="object"&&e.url!==void 0){let{url:i,...s}=e,o=(0,Ns.default)(i,s);return bn(o,n)}let a=(0,Ns.default)(e);return bn(a,n)}return bn(t[0],t[1])}(t=>{function e(r){return bn({options:{parsers:{},serializers:{}}},r)}t.mock=e})(js||(js={}));var My=Or(require("postgres"),1);var B={};Vl(B,{BRAND:()=>_5,DIRTY:()=>vr,EMPTY_PATH:()=>r5,INVALID:()=>O,NEVER:()=>cT,OK:()=>Ae,ParseStatus:()=>ke,Schema:()=>D,ZodAny:()=>Wt,ZodArray:()=>Pt,ZodBigInt:()=>xr,ZodBoolean:()=>yr,ZodBranded:()=>Va,ZodCatch:()=>jr,ZodDate:()=>br,ZodDefault:()=>Nr,ZodDiscriminatedUnion:()=>Os,ZodEffects:()=>nt,ZodEnum:()=>Cr,ZodError:()=>Qe,ZodFirstPartyTypeKind:()=>I,ZodFunction:()=>zs,ZodIntersection:()=>_r,ZodIssueCode:()=>w,ZodLazy:()=>Tr,ZodLiteral:()=>Er,ZodMap:()=>En,ZodNaN:()=>An,ZodNativeEnum:()=>Ar,ZodNever:()=>pt,ZodNull:()=>Sr,ZodNullable:()=>kt,ZodNumber:()=>gr,ZodObject:()=>He,ZodOptional:()=>tt,ZodParsedType:()=>C,ZodPipeline:()=>Qa,ZodPromise:()=>Zt,ZodReadonly:()=>qr,ZodRecord:()=>Is,ZodSchema:()=>D,ZodSet:()=>Cn,ZodString:()=>Kt,ZodSymbol:()=>_n,ZodTransformer:()=>nt,ZodTuple:()=>St,ZodType:()=>D,ZodUndefined:()=>wr,ZodUnion:()=>kr,ZodUnknown:()=>qt,ZodVoid:()=>Tn,addIssueToContext:()=>k,any:()=>O5,array:()=>F5,bigint:()=>A5,boolean:()=>zy,coerce:()=>oT,custom:()=>Py,date:()=>N5,datetimeRegex:()=>jy,defaultErrorMap:()=>Nt,discriminatedUnion:()=>B5,effect:()=>Y5,enum:()=>Z5,function:()=>G5,getErrorMap:()=>wn,getParsedType:()=>wt,instanceof:()=>E5,intersection:()=>M5,isAborted:()=>qs,isAsync:()=>Sn,isDirty:()=>Ps,isValid:()=>Gt,late:()=>T5,lazy:()=>K5,literal:()=>W5,makeIssue:()=>Ua,map:()=>Q5,nan:()=>C5,nativeEnum:()=>J5,never:()=>z5,null:()=>P5,nullable:()=>tT,number:()=>Iy,object:()=>D5,objectUtil:()=>Fl,oboolean:()=>sT,onumber:()=>iT,optional:()=>eT,ostring:()=>aT,pipeline:()=>nT,preprocess:()=>rT,promise:()=>X5,quotelessJson:()=>Y6,record:()=>V5,set:()=>H5,setErrorMap:()=>t5,strictObject:()=>R5,string:()=>Oy,symbol:()=>j5,transformer:()=>Y5,tuple:()=>U5,undefined:()=>q5,union:()=>L5,unknown:()=>I5,util:()=>L,void:()=>$5});var L;(function(t){t.assertEqual=a=>{};function e(a){}t.assertIs=e;function r(a){throw new Error}t.assertNever=r,t.arrayToEnum=a=>{let i={};for(let s of a)i[s]=s;return i},t.getValidEnumValues=a=>{let i=t.objectKeys(a).filter(o=>typeof a[a[o]]!="number"),s={};for(let o of i)s[o]=a[o];return t.objectValues(s)},t.objectValues=a=>t.objectKeys(a).map(function(i){return a[i]}),t.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{let i=[];for(let s in a)Object.prototype.hasOwnProperty.call(a,s)&&i.push(s);return i},t.find=(a,i)=>{for(let s of a)if(i(s))return s},t.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function n(a,i=" | "){return a.map(s=>typeof s=="string"?`'${s}'`:s).join(i)}t.joinValues=n,t.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(L||(L={}));var Fl;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(Fl||(Fl={}));var C=L.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),wt=t=>{switch(typeof t){case"undefined":return C.undefined;case"string":return C.string;case"number":return Number.isNaN(t)?C.nan:C.number;case"boolean":return C.boolean;case"function":return C.function;case"bigint":return C.bigint;case"symbol":return C.symbol;case"object":return Array.isArray(t)?C.array:t===null?C.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?C.promise:typeof Map<"u"&&t instanceof Map?C.map:typeof Set<"u"&&t instanceof Set?C.set:typeof Date<"u"&&t instanceof Date?C.date:C.object;default:return C.unknown}};var w=L.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Y6=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),Qe=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(i){return i.message},n={_errors:[]},a=i=>{for(let s of i.issues)if(s.code==="invalid_union")s.unionErrors.map(a);else if(s.code==="invalid_return_type")a(s.returnTypeError);else if(s.code==="invalid_arguments")a(s.argumentsError);else if(s.path.length===0)n._errors.push(r(s));else{let o=n,p=0;for(;p<s.path.length;){let c=s.path[p];p===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],p++}}};return a(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,L.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let a of this.issues)if(a.path.length>0){let i=a.path[0];r[i]=r[i]||[],r[i].push(e(a))}else n.push(e(a));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};Qe.create=t=>new Qe(t);var e5=(t,e)=>{let r;switch(t.code){case w.invalid_type:t.received===C.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case w.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,L.jsonStringifyReplacer)}`;break;case w.unrecognized_keys:r=`Unrecognized key(s) in object: ${L.joinValues(t.keys,", ")}`;break;case w.invalid_union:r="Invalid input";break;case w.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${L.joinValues(t.options)}`;break;case w.invalid_enum_value:r=`Invalid enum value. Expected ${L.joinValues(t.options)}, received '${t.received}'`;break;case w.invalid_arguments:r="Invalid function arguments";break;case w.invalid_return_type:r="Invalid function return type";break;case w.invalid_date:r="Invalid date";break;case w.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:L.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case w.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case w.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case w.custom:r="Invalid input";break;case w.invalid_intersection_types:r="Intersection results could not be merged";break;case w.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case w.not_finite:r="Number must be finite";break;default:r=e.defaultError,L.assertNever(t)}return{message:r}},Nt=e5;var Ty=Nt;function t5(t){Ty=t}function wn(){return Ty}var Ua=t=>{let{data:e,path:r,errorMaps:n,issueData:a}=t,i=[...r,...a.path||[]],s={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let o="",p=n.filter(c=>!!c).slice().reverse();for(let c of p)o=c(s,{data:e,defaultError:o}).message;return{...a,path:i,message:o}},r5=[];function k(t,e){let r=wn(),n=Ua({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===Nt?void 0:Nt].filter(a=>!!a)});t.common.issues.push(n)}var ke=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let n=[];for(let a of r){if(a.status==="aborted")return O;a.status==="dirty"&&e.dirty(),n.push(a.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let a of r){let i=await a.key,s=await a.value;n.push({key:i,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let a of r){let{key:i,value:s}=a;if(i.status==="aborted"||s.status==="aborted")return O;i.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof s.value<"u"||a.alwaysSet)&&(n[i.value]=s.value)}return{status:e.value,value:n}}},O=Object.freeze({status:"aborted"}),vr=t=>({status:"dirty",value:t}),Ae=t=>({status:"valid",value:t}),qs=t=>t.status==="aborted",Ps=t=>t.status==="dirty",Gt=t=>t.status==="valid",Sn=t=>typeof Promise<"u"&&t instanceof Promise;var j;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(j||(j={}));var rt=class{constructor(e,r,n,a){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Ey=(t,e)=>{if(Gt(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new Qe(t.common.issues);return this._error=r,this._error}}};function F(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:a}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(s,o)=>{let{message:p}=t;return s.code==="invalid_enum_value"?{message:p??o.defaultError}:typeof o.data>"u"?{message:p??n??o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:p??r??o.defaultError}},description:a}}var D=class{get description(){return this._def.description}_getType(e){return wt(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:wt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ke,ctx:{common:e.parent.common,data:e.data,parsedType:wt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Sn(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:wt(e)},a=this._parseSync({data:e,path:n.path,parent:n});return Ey(n,a)}"~validate"(e){let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:wt(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return Gt(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>Gt(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:wt(e)},a=this._parse({data:e,path:n.path,parent:n}),i=await(Sn(a)?a:Promise.resolve(a));return Ey(n,i)}refine(e,r){let n=a=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(a):r;return this._refinement((a,i)=>{let s=e(a),o=()=>i.addIssue({code:w.custom,...n(a)});return typeof Promise<"u"&&s instanceof Promise?s.then(p=>p?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((n,a)=>e(n)?!0:(a.addIssue(typeof r=="function"?r(n,a):r),!1))}_refinement(e){return new nt({schema:this,typeName:I.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return tt.create(this,this._def)}nullable(){return kt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Pt.create(this)}promise(){return Zt.create(this,this._def)}or(e){return kr.create([this,e],this._def)}and(e){return _r.create(this,e,this._def)}transform(e){return new nt({...F(this._def),schema:this,typeName:I.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new Nr({...F(this._def),innerType:this,defaultValue:r,typeName:I.ZodDefault})}brand(){return new Va({typeName:I.ZodBranded,type:this,...F(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new jr({...F(this._def),innerType:this,catchValue:r,typeName:I.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return Qa.create(this,e)}readonly(){return qr.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},n5=/^c[^\s-]{8,}$/i,a5=/^[0-9a-z]+$/,i5=/^[0-9A-HJKMNP-TV-Z]{26}$/i,s5=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,o5=/^[a-z0-9_-]{21}$/i,c5=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,p5=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,l5=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,u5="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Dl,d5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,f5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,m5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,h5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,v5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,g5=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Ay="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",x5=new RegExp(`^${Ay}$`);function Ny(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);let r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function y5(t){return new RegExp(`^${Ny(t)}$`)}function jy(t){let e=`${Ay}T${Ny(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function b5(t,e){return!!((e==="v4"||!e)&&d5.test(t)||(e==="v6"||!e)&&m5.test(t))}function w5(t,e){if(!c5.test(t))return!1;try{let[r]=t.split(".");if(!r)return!1;let n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),a=JSON.parse(atob(n));return!(typeof a!="object"||a===null||"typ"in a&&a?.typ!=="JWT"||!a.alg||e&&a.alg!==e)}catch{return!1}}function S5(t,e){return!!((e==="v4"||!e)&&f5.test(t)||(e==="v6"||!e)&&h5.test(t))}var Kt=class t extends D{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==C.string){let i=this._getOrReturnCtx(e);return k(i,{code:w.invalid_type,expected:C.string,received:i.parsedType}),O}let n=new ke,a;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(a=this._getOrReturnCtx(e,a),k(a,{code:w.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(a=this._getOrReturnCtx(e,a),k(a,{code:w.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){let s=e.data.length>i.value,o=e.data.length<i.value;(s||o)&&(a=this._getOrReturnCtx(e,a),s?k(a,{code:w.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&k(a,{code:w.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")l5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"email",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")Dl||(Dl=new RegExp(u5,"u")),Dl.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"emoji",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")s5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"uuid",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")o5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"nanoid",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")n5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"cuid",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")a5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"cuid2",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")i5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"ulid",code:w.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),k(a,{validation:"url",code:w.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"regex",code:w.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(e,a),k(a,{code:w.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(a=this._getOrReturnCtx(e,a),k(a,{code:w.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(a=this._getOrReturnCtx(e,a),k(a,{code:w.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?jy(i).test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{code:w.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?x5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{code:w.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?y5(i).test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{code:w.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?p5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"duration",code:w.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?b5(e.data,i.version)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"ip",code:w.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?w5(e.data,i.alg)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"jwt",code:w.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?S5(e.data,i.version)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"cidr",code:w.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?v5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"base64",code:w.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?g5.test(e.data)||(a=this._getOrReturnCtx(e,a),k(a,{validation:"base64url",code:w.invalid_string,message:i.message}),n.dirty()):L.assertNever(i);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(a=>e.test(a),{validation:r,code:w.invalid_string,...j.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...j.errToObj(e)})}url(e){return this._addCheck({kind:"url",...j.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...j.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...j.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...j.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...j.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...j.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...j.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...j.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...j.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...j.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...j.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...j.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...j.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...j.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...j.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...j.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...j.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...j.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...j.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...j.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...j.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...j.errToObj(r)})}nonempty(e){return this.min(1,j.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Kt.create=t=>new Kt({checks:[],typeName:I.ZodString,coerce:t?.coerce??!1,...F(t)});function k5(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,a=r>n?r:n,i=Number.parseInt(t.toFixed(a).replace(".","")),s=Number.parseInt(e.toFixed(a).replace(".",""));return i%s/10**a}var gr=class t extends D{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==C.number){let i=this._getOrReturnCtx(e);return k(i,{code:w.invalid_type,expected:C.number,received:i.parsedType}),O}let n,a=new ke;for(let i of this._def.checks)i.kind==="int"?L.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:w.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:w.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:w.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?k5(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),k(n,{code:w.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:w.not_finite,message:i.message}),a.dirty()):L.assertNever(i);return{status:a.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,j.toString(r))}gt(e,r){return this.setLimit("min",e,!1,j.toString(r))}lte(e,r){return this.setLimit("max",e,!0,j.toString(r))}lt(e,r){return this.setLimit("max",e,!1,j.toString(r))}setLimit(e,r,n,a){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:j.toString(a)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:j.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:j.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:j.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:j.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:j.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:j.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:j.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:j.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:j.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&L.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}};gr.create=t=>new gr({checks:[],typeName:I.ZodNumber,coerce:t?.coerce||!1,...F(t)});var xr=class t extends D{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==C.bigint)return this._getInvalidInput(e);let n,a=new ke;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:w.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:w.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),k(n,{code:w.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):L.assertNever(i);return{status:a.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return k(r,{code:w.invalid_type,expected:C.bigint,received:r.parsedType}),O}gte(e,r){return this.setLimit("min",e,!0,j.toString(r))}gt(e,r){return this.setLimit("min",e,!1,j.toString(r))}lte(e,r){return this.setLimit("max",e,!0,j.toString(r))}lt(e,r){return this.setLimit("max",e,!1,j.toString(r))}setLimit(e,r,n,a){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:j.toString(a)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:j.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:j.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:j.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive